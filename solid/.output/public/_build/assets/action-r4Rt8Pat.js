import{v as V,a as P,g as k,w as Z,x as ee,e as x,y as we,o as te,u as ye,z as ve,B as F,C as Re,D as Pe,b as be,F as xe,f as ne,s as W,$ as Ae}from"./index-CLQ8J1qU.js";function Ce(){let e=new Set;function t(r){return e.add(r),()=>e.delete(r)}let n=!1;function s(r,o){if(n)return!(n=!1);const i={to:r,options:o,defaultPrevented:!1,preventDefault:()=>i.defaultPrevented=!0};for(const c of e)c.listener({...i,from:c.location,retry:p=>{p&&(n=!0),c.navigate(r,{...o,resolve:!1})}});return!i.defaultPrevented}return{subscribe:t,confirm:s}}let K;function re(){(!window.history.state||window.history.state._depth==null)&&window.history.replaceState({...window.history.state,_depth:window.history.length-1},""),K=window.history.state._depth}re();function Ze(e){return{...e,_depth:window.history.state&&window.history.state._depth}}function et(e,t){let n=!1;return()=>{const s=K;re();const r=s==null?null:K-s;if(n){n=!1;return}r&&t(r)?(n=!0,window.history.go(-r)):e()}}const Oe=/^(?:[a-z0-9]+:)?\/\//i,Ee=/^\/+|(\/)\/+$/g,se="http://sr";function S(e,t=!1){const n=e.replace(Ee,"$1");return n?t||/^[?#]/.test(n)?n:"/"+n:""}function I(e,t,n){if(Oe.test(t))return;const s=S(e),r=n&&S(n);let o="";return!r||t.startsWith("/")?o=s:r.toLowerCase().indexOf(s.toLowerCase())!==0?o=s+r:o=r,(o||"/")+S(t,!o)}function Fe(e,t){if(e==null)throw new Error(t);return e}function Se(e,t){return S(e).replace(/\/*(\*.*)?$/g,"")+S(t)}function oe(e){const t={};return e.searchParams.forEach((n,s)=>{s in t?Array.isArray(t[s])?t[s].push(n):t[s]=[t[s],n]:t[s]=n}),t}function Le(e,t,n){const[s,r]=e.split("/*",2),o=s.split("/").filter(Boolean),i=o.length;return c=>{const p=c.split("/").filter(Boolean),f=p.length-i;if(f<0||f>0&&r===void 0&&!t)return null;const l={path:i?"":"/",params:{}},a=h=>n===void 0?void 0:n[h];for(let h=0;h<i;h++){const u=o[h],w=u[0]===":",g=w?p[h]:p[h].toLowerCase(),y=w?u.slice(1):u.toLowerCase();if(w&&U(g,a(y)))l.params[y]=g;else if(w||!U(g,y))return null;l.path+=`/${g}`}if(r){const h=f?p.slice(-f).join("/"):"";if(U(h,a(r)))l.params[r]=h;else return null}return l}}function U(e,t){const n=s=>s===e;return t===void 0?!0:typeof t=="string"?n(t):typeof t=="function"?t(e):Array.isArray(t)?t.some(n):t instanceof RegExp?t.test(e):!1}function _e(e){const[t,n]=e.pattern.split("/*",2),s=t.split("/").filter(Boolean);return s.reduce((r,o)=>r+(o.startsWith(":")?2:3),s.length-(n===void 0?0:1))}function ae(e){const t=new Map,n=k();return new Proxy({},{get(s,r){return t.has(r)||V(n,()=>t.set(r,P(()=>e()[r]))),t.get(r)()},getOwnPropertyDescriptor(){return{enumerable:!0,configurable:!0}},ownKeys(){return Reflect.ownKeys(e())}})}function ie(e){let t=/(\/?\:[^\/]+)\?/.exec(e);if(!t)return[e];let n=e.slice(0,t.index),s=e.slice(t.index+t[0].length);const r=[n,n+=t[1]];for(;t=/^(\/\:[^\/]+)\?/.exec(s);)r.push(n+=t[1]),s=s.slice(t[0].length);return ie(s).reduce((o,i)=>[...o,...r.map(c=>c+i)],[])}const Be=100,$e=ee(),je=ee(),z=()=>Fe(Z($e),"<A> and 'use' router primitives can be only used inside a Route."),De=()=>z().navigatorFactory();function Ie(e,t=""){const{component:n,preload:s,load:r,children:o,info:i}=e,c=!o||Array.isArray(o)&&!o.length,p={key:e,component:n,preload:s||r,info:i};return ce(e.path).reduce((f,l)=>{for(const a of ie(l)){const h=Se(t,a);let u=c?h:h.split("/*",1)[0];u=u.split("/").map(w=>w.startsWith(":")||w.startsWith("*")?w:encodeURIComponent(w)).join("/"),f.push({...p,originalPath:l,pattern:u,matcher:Le(u,!c,e.matchFilters)})}return f},[])}function Me(e,t=0){return{routes:e,score:_e(e[e.length-1])*1e4-t,matcher(n){const s=[];for(let r=e.length-1;r>=0;r--){const o=e[r],i=o.matcher(n);if(!i)return null;s.unshift({...i,route:o})}return s}}}function ce(e){return Array.isArray(e)?e:[e]}function Te(e,t="",n=[],s=[]){const r=ce(e);for(let o=0,i=r.length;o<i;o++){const c=r[o];if(c&&typeof c=="object"){c.hasOwnProperty("path")||(c.path="");const p=Ie(c,t);for(const f of p){n.push(f);const l=Array.isArray(c.children)&&c.children.length===0;if(c.children&&!l)Te(c.children,f.pattern,n,s);else{const a=Me([...n],s.length);s.push(a)}n.pop()}}}return n.length?s:s.sort((o,i)=>i.score-o.score)}function q(e,t){for(let n=0,s=e.length;n<s;n++){const r=e[n].matcher(t);if(r)return r}return[]}function We(e,t,n){const s=new URL(se),r=P(l=>{const a=e();try{return new URL(a,s)}catch{return console.error(`Invalid path ${a}`),l}},s,{equals:(l,a)=>l.href===a.href}),o=P(()=>r().pathname),i=P(()=>r().search,!0),c=P(()=>r().hash),p=()=>"",f=te(i,()=>oe(r()));return{get pathname(){return o()},get search(){return i()},get hash(){return c()},get state(){return t()},get key(){return p()},query:n?n(f):ae(f)}}let b;function Ue(){return b}let O=!1;function qe(){return O}function tt(e){O=e}function nt(e,t,n,s={}){const{signal:[r,o],utils:i={}}=e,c=i.parsePath||(d=>d),p=i.renderPath||(d=>d),f=i.beforeLeave||Ce(),l=I("",s.base||"");if(l===void 0)throw new Error(`${l} is not a valid base path`);l&&!r().value&&o({value:l,replace:!0,scroll:!1});const[a,h]=x(!1);let u;const w=(d,m)=>{m.value===g()&&m.state===R()||(u===void 0&&h(!0),b=d,u=m,F(()=>{u===m&&(y(u.value),fe(u.state),Re(),H[1](v=>v.filter(A=>A.pending)))}).finally(()=>{u===m&&Pe(()=>{b=void 0,d==="navigate"&&ge(u),h(!1),u=void 0})}))},[g,y]=x(r().value),[R,fe]=x(r().state),$=We(g,R,i.queryWrapper),j=[],H=x([]),N=P(()=>typeof s.transformUrl=="function"?q(t(),s.transformUrl($.pathname)):q(t(),$.pathname)),G=()=>{const d=N(),m={};for(let v=0;v<d.length;v++)Object.assign(m,d[v].params);return m},he=i.paramsWrapper?i.paramsWrapper(G,t):ae(G),J={pattern:l,path:()=>l,outlet:()=>null,resolvePath(d){return I(l,d)}};return we(te(r,d=>w("native",d),{defer:!0})),{base:J,location:$,params:he,isRouting:a,renderPath:p,parsePath:c,navigatorFactory:pe,matches:N,beforeLeave:f,preloadRoute:me,singleFlight:s.singleFlight===void 0?!0:s.singleFlight,submissions:H};function de(d,m,v){ye(()=>{if(typeof m=="number"){m&&(i.go?i.go(m):console.warn("Router integration does not support relative routing"));return}const A=!m||m[0]==="?",{replace:M,resolve:C,scroll:T,state:E}={replace:!1,resolve:!A,scroll:!0,...v},D=C?d.resolvePath(m):I(A&&$.pathname||"",m);if(D===void 0)throw new Error(`Path '${m}' is not a routable path`);if(j.length>=Be)throw new Error("Too many redirects");const Y=g();(D!==Y||E!==R())&&(ve||f.confirm(D,v)&&(j.push({value:Y,replace:M,scroll:T,state:R()}),w("navigate",{value:D,state:E})))})}function pe(d){return d=d||Z(je)||J,(m,v)=>de(d,m,v)}function ge(d){const m=j[0];m&&(o({...d,replace:m.replace,scroll:m.scroll}),j.length=0)}function me(d,m){const v=q(t(),d.pathname),A=b;b="preload";for(let M in v){const{route:C,params:T}=v[M];C.component&&C.component.preload&&C.component.preload();const{preload:E}=C;O=!0,m&&E&&V(n(),()=>E({params:T,location:{pathname:d.pathname,search:d.search,hash:d.hash,query:oe(d),state:null,key:""},intent:"preload"})),O=!1}b=A}}function rt(e,t,n,s){const{base:r,location:o,params:i}=e,{pattern:c,component:p,preload:f}=s().route,l=P(()=>s().path);p&&p.preload&&p.preload(),O=!0;const a=f?f({params:i,location:o,intent:b||"initial"}):void 0;return O=!1,{parent:t,pattern:c,path:l,outlet:()=>p?be(p,{params:i,location:o,data:a,get children(){return n()}}):n(),resolvePath(u){return I(r.path(),u,l())}}}const Ke="Location",Xe=5e3,ke=18e4;let L=new Map;setInterval(()=>{const e=Date.now();for(let[t,n]of L.entries())!n[4].count&&e-n[0]>ke&&L.delete(t)},3e5);function _(){return L}function ze(e,t=!0){return F(()=>{const n=Date.now();ue(e,s=>{t&&(s[0]=0),s[4][1](n)})})}function ue(e,t){e&&!Array.isArray(e)&&(e=[e]);for(let n of L.keys())(e===void 0||He(n,e))&&t(L.get(n))}function B(e,t){e.GET&&(e=e.GET);const n=(...s)=>{const r=_(),o=Ue(),i=qe(),p=k()?De():void 0,f=Date.now(),l=t+X(s);let a=r.get(l),h;if(xe()&&(h=!0,ne(()=>a[4].count--)),a&&a[0]&&(o==="native"||a[4].count||Date.now()-a[0]<Xe)){h&&(a[4].count++,a[4][0]()),a[3]==="preload"&&o!=="preload"&&(a[0]=f);let g=a[1];return o!=="preload"&&(g="then"in a[1]?a[1].then(w(!1),w(!0)):w(!1)(a[1]),o==="navigate"&&F(()=>a[4][1](a[0]))),i&&"then"in g&&g.catch(()=>{}),g}let u;return W.has&&W.has(l)?(u=W.load(l),delete globalThis._$HY.r[l]):u=e(...s),a?(a[0]=f,a[1]=u,a[3]=o,o==="navigate"&&F(()=>a[4][1](a[0]))):(r.set(l,a=[f,u,,o,x(f)]),a[4].count=0),h&&(a[4].count++,a[4][0]()),o!=="preload"&&(u="then"in u?u.then(w(!1),w(!0)):w(!1)(u)),i&&"then"in u&&u.catch(()=>{}),u;function w(g){return async y=>{if(y instanceof Response){const R=y.headers.get(Ke);if(R!==null){p&&R.startsWith("/")?F(()=>{p(R,{replace:!0})}):window.location.href=R;return}y.customBody&&(y=await y.customBody())}if(g)throw y;return a[2]=y,y}}};return n.keyFor=(...s)=>t+X(s),n.key=t,n}B.get=e=>_().get(e)[2];B.set=(e,t)=>{const n=_(),s=Date.now();let r=n.get(e);r?(r[0]=s,r[1]=Promise.resolve(t),r[2]=t,r[3]="preload"):(n.set(e,r=[s,Promise.resolve(t),t,"preload",x(s)]),r[4].count=0)};B.delete=e=>_().delete(e);B.clear=()=>_().clear();function He(e,t){for(let n of t)if(n&&e.startsWith(n))return!0;return!1}function X(e){return JSON.stringify(e,(t,n)=>Ne(n)?Object.keys(n).sort().reduce((s,r)=>(s[r]=n[r],s),{}):n)}function Ne(e){let t;return e!=null&&typeof e=="object"&&(!(t=Object.getPrototypeOf(e))||t===Object.prototype)}const Q=new Map;function Ge(e,t){const n=z(),s=P(()=>n.submissions[0]().filter(r=>r.url===e.base&&!0));return new Proxy([],{get(r,o){return o===Ae?s():o==="pending"?s().some(i=>!i.result):s()[o]},has(r,o){return o in s()}})}function st(e,t){const n=Ge(e);return new Proxy({},{get(s,r){return n.length===0&&r==="clear"||r==="retry"?()=>{}:n[n.length-1]?.[r]}})}function ot(e){const t=z();return(...n)=>e.apply({r:t},n)}function at(e,t={}){function n(...o){const i=this.r,c=this.f,p=(i.singleFlight&&e.withOptions?e.withOptions({headers:{"X-Single-Flight":"true"}}):e)(...o),[f,l]=x();let a;function h(u){return async w=>{const g=await Ye(w,u,i.navigatorFactory());let y=null;if(s.onComplete?.({...a,result:g?.data,error:g?.error,pending:!1,retry(){return y=a.retry()}}),y)return y;if(!g)return a.clear();if(l(g),g.error&&!c)throw g.error;return g.data}}return i.submissions[1](u=>[...u,a={input:o,url:r,get result(){return f()?.data},get error(){return f()?.error},get pending(){return!f()},clear(){i.submissions[1](w=>w.filter(g=>g!==a))},retry(){return l(void 0),e(...o).then(h(),h(!0))}}]),p.then(h(),h(!0))}const s=typeof t=="string"?{name:t}:t,r=e.url||s.name&&`https://action/${s.name}`||`https://action/${Je(e.toString())}`;return n.base=r,le(n,r)}function le(e,t){return e.toString=()=>{if(!t)throw new Error("Client Actions need explicit names if server rendered");return t},e.with=function(...n){const s=function(...o){return e.call(this,...n,...o)};s.base=e.base;const r=new URL(t,se);return r.searchParams.set("args",X(n)),le(s,(r.origin==="https://action"?r.origin:"")+r.pathname+r.search)},e.url=t,Q.set(t,e),k()&&ne(()=>Q.delete(t)),e}const Je=e=>e.split("").reduce((t,n)=>(t<<5)-t+n.charCodeAt(0)|0,0);async function Ye(e,t,n){let s,r,o,i;if(e instanceof Response){if(e.headers.has("X-Revalidate")&&(o=e.headers.get("X-Revalidate").split(",")),e.customBody&&(s=r=await e.customBody(),e.headers.has("X-Single-Flight")&&(s=s._$value,delete r._$value,i=Object.keys(r))),e.headers.has("Location")){const c=e.headers.get("Location")||"/";c.startsWith("http")?window.location.href=c:n(c)}}else{if(t)return{error:e};s=e}return ue(o,c=>c[0]=0),i&&i.forEach(c=>B.set(c,r[c])),await ze(o,!1),s!=null?{data:s}:void 0}export{$e as R,nt as a,je as b,Te as c,rt as d,Q as e,Ce as f,Ue as g,re as h,at as i,st as j,Ze as k,se as m,et as n,tt as s,ot as u};
