import{lazy as Be,createComponent as We,sharedConfig as we}from"solid-js";import{ssrElement as O,escape as qe,mergeProps as He,ssr as Ke,getRequestEvent as Xe,isServer as Ye,renderToString as Ge}from"solid-js/web";import{provideRequestEvent as Ae}from"solid-js/web/storage";import{g as Ze,s as Je,a as Qe,m as le,b as oe,c as $,d as et,p as tt}from"./fetchEvent-DZma46F8.js";import{eventHandler as rt}from"h3";import"node:async_hooks";var st=(t=>(t[t.AggregateError=1]="AggregateError",t[t.ArrowFunction=2]="ArrowFunction",t[t.ErrorPrototypeStack=4]="ErrorPrototypeStack",t[t.ObjectAssign=8]="ObjectAssign",t[t.BigIntTypedArray=16]="BigIntTypedArray",t[t.AbortSignal=32]="AbortSignal",t))(st||{});function at(t){switch(t){case'"':return'\\"';case"\\":return"\\\\";case`
`:return"\\n";case"\r":return"\\r";case"\b":return"\\b";case"	":return"\\t";case"\f":return"\\f";case"<":return"\\x3C";case"\u2028":return"\\u2028";case"\u2029":return"\\u2029";default:return}}function g(t){let e="",r=0,a;for(let i=0,n=t.length;i<n;i++)a=at(t[i]),a&&(e+=t.slice(r,i)+a,r=i+1);return r===0?e=t:e+=t.slice(r),e}function it(t){switch(t){case"\\\\":return"\\";case'\\"':return'"';case"\\n":return`
`;case"\\r":return"\r";case"\\b":return"\b";case"\\t":return"	";case"\\f":return"\f";case"\\x3C":return"<";case"\\u2028":return"\u2028";case"\\u2029":return"\u2029";default:return t}}function S(t){return t.replace(/(\\\\|\\"|\\n|\\r|\\b|\\t|\\f|\\u2028|\\u2029|\\x3C)/g,it)}var R="__SEROVAL_REFS__",j="$R",V=`self.${j}`;function nt(t){return t==null?`${V}=${V}||[]`:`(${V}=${V}||{})["${g(t)}"]=[]`}function y(t,e){if(!t)throw e}var Re=new Map,w=new Map;function Ie(t){return Re.has(t)}function lt(t){return w.has(t)}function ot(t){return y(Ie(t),new qt(t)),Re.get(t)}function ut(t){return y(lt(t),new Ht(t)),w.get(t)}typeof globalThis<"u"?Object.defineProperty(globalThis,R,{value:w,configurable:!0,writable:!1,enumerable:!1}):typeof window<"u"?Object.defineProperty(window,R,{value:w,configurable:!0,writable:!1,enumerable:!1}):typeof self<"u"?Object.defineProperty(self,R,{value:w,configurable:!0,writable:!1,enumerable:!1}):typeof global<"u"&&Object.defineProperty(global,R,{value:w,configurable:!0,writable:!1,enumerable:!1});function Ee(t,e){for(let r=0,a=e.length;r<a;r++){let i=e[r];t.has(i)||(t.add(i),i.extends&&Ee(t,i.extends))}}function xe(t){if(t){let e=new Set;return Ee(e,t),[...e]}}var ct={0:"Symbol.asyncIterator",1:"Symbol.hasInstance",2:"Symbol.isConcatSpreadable",3:"Symbol.iterator",4:"Symbol.match",5:"Symbol.matchAll",6:"Symbol.replace",7:"Symbol.search",8:"Symbol.species",9:"Symbol.split",10:"Symbol.toPrimitive",11:"Symbol.toStringTag",12:"Symbol.unscopables"},Pe={[Symbol.asyncIterator]:0,[Symbol.hasInstance]:1,[Symbol.isConcatSpreadable]:2,[Symbol.iterator]:3,[Symbol.match]:4,[Symbol.matchAll]:5,[Symbol.replace]:6,[Symbol.search]:7,[Symbol.species]:8,[Symbol.split]:9,[Symbol.toPrimitive]:10,[Symbol.toStringTag]:11,[Symbol.unscopables]:12},ht={0:Symbol.asyncIterator,1:Symbol.hasInstance,2:Symbol.isConcatSpreadable,3:Symbol.iterator,4:Symbol.match,5:Symbol.matchAll,6:Symbol.replace,7:Symbol.search,8:Symbol.species,9:Symbol.split,10:Symbol.toPrimitive,11:Symbol.toStringTag,12:Symbol.unscopables},ft={2:"!0",3:"!1",1:"void 0",0:"null",4:"-0",5:"1/0",6:"-1/0",7:"0/0"},dt={2:!0,3:!1,1:void 0,0:null,4:-0,5:Number.POSITIVE_INFINITY,6:Number.NEGATIVE_INFINITY,7:Number.NaN},ke={0:"Error",1:"EvalError",2:"RangeError",3:"ReferenceError",4:"SyntaxError",5:"TypeError",6:"URIError"},pt={0:Error,1:EvalError,2:RangeError,3:ReferenceError,4:SyntaxError,5:TypeError,6:URIError},s=void 0;function f(t,e,r,a,i,n,l,o,u,c,d,m){return{t,i:e,s:r,l:a,c:i,m:n,p:l,e:o,a:u,f:c,b:d,o:m}}function z(t){return f(2,s,t,s,s,s,s,s,s,s,s,s)}var B=z(2),W=z(3),gt=z(1),mt=z(0),yt=z(4),bt=z(5),zt=z(6),St=z(7);function te(t){return t instanceof EvalError?1:t instanceof RangeError?2:t instanceof ReferenceError?3:t instanceof SyntaxError?4:t instanceof TypeError?5:t instanceof URIError?6:0}function vt(t){let e=ke[te(t)];return t.name!==e?{name:t.name}:t.constructor.name!==e?{name:t.constructor.name}:{}}function ue(t,e){let r=vt(t),a=Object.getOwnPropertyNames(t);for(let i=0,n=a.length,l;i<n;i++)l=a[i],l!=="name"&&l!=="message"&&(l==="stack"?e&4&&(r=r||{},r[l]=t[l]):(r=r||{},r[l]=t[l]));return r}function Fe(t){return Object.isFrozen(t)?3:Object.isSealed(t)?2:Object.isExtensible(t)?0:1}function wt(t){switch(t){case Number.POSITIVE_INFINITY:return bt;case Number.NEGATIVE_INFINITY:return zt}return t!==t?St:Object.is(t,-0)?yt:f(0,s,t,s,s,s,s,s,s,s,s,s)}function q(t){return f(1,s,g(t),s,s,s,s,s,s,s,s,s)}function At(t){return f(3,s,""+t,s,s,s,s,s,s,s,s,s)}function Rt(t){return f(4,t,s,s,s,s,s,s,s,s,s,s)}function It(t,e){return f(5,t,e.toISOString(),s,s,s,s,s,s,s,s,s)}function Et(t,e){return f(6,t,s,s,g(e.source),e.flags,s,s,s,s,s,s)}function xt(t,e){let r=new Uint8Array(e),a=r.length,i=new Array(a);for(let n=0;n<a;n++)i[n]=r[n];return f(19,t,i,s,s,s,s,s,s,s,s,s)}function Pt(t,e){return f(17,t,Pe[e],s,s,s,s,s,s,s,s,s)}function kt(t,e){return f(18,t,g(ot(e)),s,s,s,s,s,s,s,s,s)}function Ce(t,e,r){return f(25,t,r,s,g(e),s,s,s,s,s,s,s)}function Ft(t,e,r){return f(9,t,s,e.length,s,s,s,s,r,s,s,Fe(e))}function Ct(t,e){return f(21,t,s,s,s,s,s,s,s,e,s,s)}function Ot(t,e,r){return f(15,t,s,e.length,e.constructor.name,s,s,s,s,r,e.byteOffset,s)}function $t(t,e,r){return f(16,t,s,e.length,e.constructor.name,s,s,s,s,r,e.byteOffset,s)}function Vt(t,e,r){return f(20,t,s,e.byteLength,s,s,s,s,s,r,e.byteOffset,s)}function jt(t,e,r){return f(13,t,te(e),s,s,g(e.message),r,s,s,s,s,s)}function Nt(t,e,r){return f(14,t,te(e),s,s,g(e.message),r,s,s,s,s,s)}function Tt(t,e,r){return f(7,t,s,e,s,s,s,s,r,s,s,s)}function Oe(t,e){return f(28,s,s,s,s,s,s,s,[t,e],s,s,s)}function $e(t,e){return f(30,s,s,s,s,s,s,s,[t,e],s,s,s)}function Ve(t,e,r){return f(31,t,s,s,s,s,s,s,r,e,s,s)}function Dt(t,e){return f(32,t,s,s,s,s,s,s,s,e,s,s)}function Mt(t,e){return f(33,t,s,s,s,s,s,s,s,e,s,s)}function Ut(t,e){return f(34,t,s,s,s,s,s,s,s,e,s,s)}var{toString:re}=Object.prototype;function Lt(t,e){return e instanceof Error?`Seroval caught an error during the ${t} process.
  
${e.name}
${e.message}

- For more information, please check the "cause" property of this error.
- If you believe this is an error in Seroval, please submit an issue at https://github.com/lxsmnsyc/seroval/issues/new`:`Seroval caught an error during the ${t} process.

"${re.call(e)}"

For more information, please check the "cause" property of this error.`}var se=class extends Error{constructor(e,r){super(Lt(e,r)),this.cause=r}},_t=class extends se{constructor(e){super("parsing",e)}},Bt=class extends se{constructor(t){super("serialization",t)}},Wt=class extends se{constructor(t){super("deserialization",t)}},N=class extends Error{constructor(e){super(`The value ${re.call(e)} of type "${typeof e}" cannot be parsed/serialized.
      
There are few workarounds for this problem:
- Transform the value in a way that it can be serialized.
- If the reference is present on multiple runtimes (isomorphic), you can use the Reference API to map the references.`),this.value=e}},je=class extends Error{constructor(e){super('Unsupported node type "'+e.t+'".')}},Ne=class extends Error{constructor(t){super('Missing plugin for tag "'+t+'".')}},v=class extends Error{constructor(t){super('Missing "'+t+'" instance.')}},qt=class extends Error{constructor(t){super('Missing reference for the value "'+re.call(t)+'" of type "'+typeof t+'"'),this.value=t}},Ht=class extends Error{constructor(e){super('Missing reference for id "'+g(e)+'"')}},Kt=class extends Error{constructor(t){super('Unknown TypedArray "'+t+'"')}},Xt=class{constructor(t,e){this.value=t,this.replacement=e}},Yt={},Gt={},Zt={0:{},1:{},2:{},3:{},4:{},5:{},6:{}};function H(){let t,e;return{promise:new Promise((r,a)=>{t=r,e=a}),resolve(r){t(r)},reject(r){e(r)}}}function Jt(t){return"__SEROVAL_STREAM__"in t}function F(){let t=new Set,e=[],r=!0,a=!0;function i(o){for(let u of t.keys())u.next(o)}function n(o){for(let u of t.keys())u.throw(o)}function l(o){for(let u of t.keys())u.return(o)}return{__SEROVAL_STREAM__:!0,on(o){r&&t.add(o);for(let u=0,c=e.length;u<c;u++){let d=e[u];u===c-1&&!r?a?o.return(d):o.throw(d):o.next(d)}return()=>{r&&t.delete(o)}},next(o){r&&(e.push(o),i(o))},throw(o){r&&(e.push(o),n(o),r=!1,a=!1,t.clear())},return(o){r&&(e.push(o),l(o),r=!1,a=!0,t.clear())}}}function Qt(t){let e=F(),r=t[Symbol.asyncIterator]();async function a(){try{let i=await r.next();i.done?e.return(i.value):(e.next(i.value),await a())}catch(i){e.throw(i)}}return a().catch(()=>{}),e}function er(t){return()=>{let e=[],r=[],a=0,i=-1,n=!1;function l(){for(let u=0,c=r.length;u<c;u++)r[u].resolve({done:!0,value:void 0})}t.on({next(u){let c=r.shift();c&&c.resolve({done:!1,value:u}),e.push(u)},throw(u){let c=r.shift();c&&c.reject(u),l(),i=e.length,e.push(u),n=!0},return(u){let c=r.shift();c&&c.resolve({done:!0,value:u}),l(),i=e.length,e.push(u)}});function o(){let u=a++,c=e[u];if(u!==i)return{done:!1,value:c};if(n)throw c;return{done:!0,value:c}}return{[Symbol.asyncIterator](){return this},async next(){if(i===-1){let u=a++;if(u>=e.length){let c=H();return r.push(c),await c.promise}return{done:!1,value:e[u]}}return a>i?{done:!0,value:void 0}:o()}}}}function Te(t){let e=[],r=-1,a=-1,i=t[Symbol.iterator]();for(;;)try{let n=i.next();if(e.push(n.value),n.done){a=e.length-1;break}}catch(n){r=e.length,e.push(n)}return{v:e,t:r,d:a}}function tr(t){return()=>{let e=0;return{[Symbol.iterator](){return this},next(){if(e>t.d)return{done:!0,value:s};let r=e++,a=t.v[r];if(r===t.t)throw a;return{done:r===t.d,value:a}}}}}var rr=class{constructor(e){this.marked=new Set,this.plugins=e.plugins,this.features=47^(e.disabledFeatures||0),this.refs=e.refs||new Map}markRef(e){this.marked.add(e)}isMarked(e){return this.marked.has(e)}getIndexedValue(e){let r=this.refs.get(e);if(r!=null)return this.markRef(r),{type:1,value:Rt(r)};let a=this.refs.size;return this.refs.set(e,a),{type:0,value:a}}getReference(e){let r=this.getIndexedValue(e);return r.type===1?r:Ie(e)?{type:2,value:kt(r.value,e)}:r}parseWellKnownSymbol(e){let r=this.getReference(e);return r.type!==0?r.value:(y(e in Pe,new N(e)),Pt(r.value,e))}parseSpecialReference(e){let r=this.getIndexedValue(Zt[e]);return r.type===1?r.value:f(26,r.value,e,s,s,s,s,s,s,s,s,s)}parseIteratorFactory(){let e=this.getIndexedValue(Yt);return e.type===1?e.value:f(27,e.value,s,s,s,s,s,s,s,this.parseWellKnownSymbol(Symbol.iterator),s,s)}parseAsyncIteratorFactory(){let e=this.getIndexedValue(Gt);return e.type===1?e.value:f(29,e.value,s,s,s,s,s,s,[this.parseSpecialReference(1),this.parseWellKnownSymbol(Symbol.asyncIterator)],s,s,s)}createObjectNode(e,r,a,i){return f(a?11:10,e,s,s,s,s,i,s,s,s,s,Fe(r))}createMapNode(e,r,a,i){return f(8,e,s,s,s,s,s,{k:r,v:a,s:i},s,this.parseSpecialReference(0),s,s)}createPromiseConstructorNode(e){return f(22,e,s,s,s,s,s,s,s,this.parseSpecialReference(1),s,s)}createAbortSignalConstructorNode(e){return f(35,e,s,s,s,s,s,s,s,this.parseSpecialReference(5),s,s)}};function sr(t){switch(t){case"Int8Array":return Int8Array;case"Int16Array":return Int16Array;case"Int32Array":return Int32Array;case"Uint8Array":return Uint8Array;case"Uint16Array":return Uint16Array;case"Uint32Array":return Uint32Array;case"Uint8ClampedArray":return Uint8ClampedArray;case"Float32Array":return Float32Array;case"Float64Array":return Float64Array;case"BigInt64Array":return BigInt64Array;case"BigUint64Array":return BigUint64Array;default:throw new Kt(t)}}function ce(t,e){switch(e){case 3:return Object.freeze(t);case 1:return Object.preventExtensions(t);case 2:return Object.seal(t);default:return t}}var ar=class{constructor(e){this.plugins=e.plugins,this.refs=e.refs||new Map}deserializeReference(e){return this.assignIndexedValue(e.i,ut(S(e.s)))}deserializeArray(e){let r=e.l,a=this.assignIndexedValue(e.i,new Array(r)),i;for(let n=0;n<r;n++)i=e.a[n],i&&(a[n]=this.deserialize(i));return ce(a,e.o),a}deserializeProperties(e,r){let a=e.s;if(a){let i=e.k,n=e.v;for(let l=0,o;l<a;l++)o=i[l],typeof o=="string"?r[S(o)]=this.deserialize(n[l]):r[this.deserialize(o)]=this.deserialize(n[l])}return r}deserializeObject(e){let r=this.assignIndexedValue(e.i,e.t===10?{}:Object.create(null));return this.deserializeProperties(e.p,r),ce(r,e.o),r}deserializeDate(e){return this.assignIndexedValue(e.i,new Date(e.s))}deserializeRegExp(e){return this.assignIndexedValue(e.i,new RegExp(S(e.c),e.m))}deserializeSet(e){let r=this.assignIndexedValue(e.i,new Set),a=e.a;for(let i=0,n=e.l;i<n;i++)r.add(this.deserialize(a[i]));return r}deserializeMap(e){let r=this.assignIndexedValue(e.i,new Map),a=e.e.k,i=e.e.v;for(let n=0,l=e.e.s;n<l;n++)r.set(this.deserialize(a[n]),this.deserialize(i[n]));return r}deserializeArrayBuffer(e){let r=new Uint8Array(e.s);return this.assignIndexedValue(e.i,r.buffer)}deserializeTypedArray(e){let r=sr(e.c),a=this.deserialize(e.f);return this.assignIndexedValue(e.i,new r(a,e.b,e.l))}deserializeDataView(e){let r=this.deserialize(e.f);return this.assignIndexedValue(e.i,new DataView(r,e.b,e.l))}deserializeDictionary(e,r){if(e.p){let a=this.deserializeProperties(e.p,{});Object.assign(r,a)}return r}deserializeAggregateError(e){let r=this.assignIndexedValue(e.i,new AggregateError([],S(e.m)));return this.deserializeDictionary(e,r)}deserializeError(e){let r=pt[e.s],a=this.assignIndexedValue(e.i,new r(S(e.m)));return this.deserializeDictionary(e,a)}deserializePromise(e){let r=H(),a=this.assignIndexedValue(e.i,r),i=this.deserialize(e.f);return e.s?r.resolve(i):r.reject(i),a.promise}deserializeBoxed(e){return this.assignIndexedValue(e.i,Object(this.deserialize(e.f)))}deserializePlugin(e){let r=this.plugins;if(r){let a=S(e.c);for(let i=0,n=r.length;i<n;i++){let l=r[i];if(l.tag===a)return this.assignIndexedValue(e.i,l.deserialize(e.s,this,{id:e.i}))}}throw new Ne(e.c)}deserializePromiseConstructor(e){return this.assignIndexedValue(e.i,H()).promise}deserializePromiseResolve(e){let r=this.refs.get(e.i);y(r,new v("Promise")),r.resolve(this.deserialize(e.a[1]))}deserializePromiseReject(e){let r=this.refs.get(e.i);y(r,new v("Promise")),r.reject(this.deserialize(e.a[1]))}deserializeIteratorFactoryInstance(e){this.deserialize(e.a[0]);let r=this.deserialize(e.a[1]);return tr(r)}deserializeAsyncIteratorFactoryInstance(e){this.deserialize(e.a[0]);let r=this.deserialize(e.a[1]);return er(r)}deserializeStreamConstructor(e){let r=this.assignIndexedValue(e.i,F()),a=e.a.length;if(a)for(let i=0;i<a;i++)this.deserialize(e.a[i]);return r}deserializeStreamNext(e){let r=this.refs.get(e.i);y(r,new v("Stream")),r.next(this.deserialize(e.f))}deserializeStreamThrow(e){let r=this.refs.get(e.i);y(r,new v("Stream")),r.throw(this.deserialize(e.f))}deserializeStreamReturn(e){let r=this.refs.get(e.i);y(r,new v("Stream")),r.return(this.deserialize(e.f))}deserializeIteratorFactory(e){this.deserialize(e.f)}deserializeAsyncIteratorFactory(e){this.deserialize(e.a[1])}deserializeAbortSignalConstructor(e){return this.assignIndexedValue(e.i,new AbortController).signal}deserializeAbortSignalAbort(e){let r=this.refs.get(e.i);y(r,new v("AbortSignal")),r.abort(this.deserialize(e.a[1]))}deserializeAbortSignalSync(e){return this.assignIndexedValue(e.i,AbortSignal.abort(this.deserialize(e.f)))}deserialize(e){try{switch(e.t){case 2:return dt[e.s];case 0:return e.s;case 1:return S(e.s);case 3:return BigInt(e.s);case 4:return this.refs.get(e.i);case 18:return this.deserializeReference(e);case 9:return this.deserializeArray(e);case 10:case 11:return this.deserializeObject(e);case 5:return this.deserializeDate(e);case 6:return this.deserializeRegExp(e);case 7:return this.deserializeSet(e);case 8:return this.deserializeMap(e);case 19:return this.deserializeArrayBuffer(e);case 16:case 15:return this.deserializeTypedArray(e);case 20:return this.deserializeDataView(e);case 14:return this.deserializeAggregateError(e);case 13:return this.deserializeError(e);case 12:return this.deserializePromise(e);case 17:return ht[e.s];case 21:return this.deserializeBoxed(e);case 25:return this.deserializePlugin(e);case 22:return this.deserializePromiseConstructor(e);case 23:return this.deserializePromiseResolve(e);case 24:return this.deserializePromiseReject(e);case 28:return this.deserializeIteratorFactoryInstance(e);case 30:return this.deserializeAsyncIteratorFactoryInstance(e);case 31:return this.deserializeStreamConstructor(e);case 32:return this.deserializeStreamNext(e);case 33:return this.deserializeStreamThrow(e);case 34:return this.deserializeStreamReturn(e);case 27:return this.deserializeIteratorFactory(e);case 29:return this.deserializeAsyncIteratorFactory(e);case 36:return this.deserializeAbortSignalAbort(e);case 35:return this.deserializeAbortSignalConstructor(e);case 37:return this.deserializeAbortSignalSync(e);default:throw new je(e)}}catch(r){throw new Wt(r)}}},ir=/^[$A-Z_][0-9A-Z_$]*$/i;function he(t){let e=t[0];return(e==="$"||e==="_"||e>="A"&&e<="Z"||e>="a"&&e<="z")&&ir.test(t)}function I(t){switch(t.t){case 0:return t.s+"="+t.v;case 2:return t.s+".set("+t.k+","+t.v+")";case 1:return t.s+".add("+t.v+")";case 3:return t.s+".delete("+t.k+")"}}function nr(t){let e=[],r=t[0];for(let a=1,i=t.length,n,l=r;a<i;a++)n=t[a],n.t===0&&n.v===l.v?r={t:0,s:n.s,k:s,v:I(r)}:n.t===2&&n.s===l.s?r={t:2,s:I(r),k:n.k,v:n.v}:n.t===1&&n.s===l.s?r={t:1,s:I(r),k:s,v:n.v}:n.t===3&&n.s===l.s?r={t:3,s:I(r),k:n.k,v:s}:(e.push(r),r=n),l=n;return e.push(r),e}function fe(t){if(t.length){let e="",r=nr(t);for(let a=0,i=r.length;a<i;a++)e+=I(r[a])+",";return e}return s}var lr="Object.create(null)",or="new Set",ur="new Map",cr="Promise.resolve",hr="Promise.reject",fr={3:"Object.freeze",2:"Object.seal",1:"Object.preventExtensions",0:s},dr=class{constructor(e){this.stack=[],this.flags=[],this.assignments=[],this.plugins=e.plugins,this.features=e.features,this.marked=new Set(e.markedRefs)}createFunction(e,r){return this.features&2?(e.length===1?e[0]:"("+e.join(",")+")")+"=>"+(r.startsWith("{")?"("+r+")":r):"function("+e.join(",")+"){return "+r+"}"}createEffectfulFunction(e,r){return this.features&2?(e.length===1?e[0]:"("+e.join(",")+")")+"=>{"+r+"}":"function("+e.join(",")+"){"+r+"}"}markRef(e){this.marked.add(e)}isMarked(e){return this.marked.has(e)}pushObjectFlag(e,r){e!==0&&(this.markRef(r),this.flags.push({type:e,value:this.getRefParam(r)}))}resolveFlags(){let e="";for(let r=0,a=this.flags,i=a.length;r<i;r++){let n=a[r];e+=fr[n.type]+"("+n.value+"),"}return e}resolvePatches(){let e=fe(this.assignments),r=this.resolveFlags();return e?r?e+r:e:r}createAssignment(e,r){this.assignments.push({t:0,s:e,k:s,v:r})}createAddAssignment(e,r){this.assignments.push({t:1,s:this.getRefParam(e),k:s,v:r})}createSetAssignment(e,r,a){this.assignments.push({t:2,s:this.getRefParam(e),k:r,v:a})}createDeleteAssignment(e,r){this.assignments.push({t:3,s:this.getRefParam(e),k:r,v:s})}createArrayAssign(e,r,a){this.createAssignment(this.getRefParam(e)+"["+r+"]",a)}createObjectAssign(e,r,a){this.createAssignment(this.getRefParam(e)+"."+r,a)}isIndexedValueInStack(e){return e.t===4&&this.stack.includes(e.i)}serializeReference(e){return this.assignIndexedValue(e.i,R+'.get("'+e.s+'")')}serializeArrayItem(e,r,a){return r?this.isIndexedValueInStack(r)?(this.markRef(e),this.createArrayAssign(e,a,this.getRefParam(r.i)),""):this.serialize(r):""}serializeArray(e){let r=e.i;if(e.l){this.stack.push(r);let a=e.a,i=this.serializeArrayItem(r,a[0],0),n=i==="";for(let l=1,o=e.l,u;l<o;l++)u=this.serializeArrayItem(r,a[l],l),i+=","+u,n=u==="";return this.stack.pop(),this.pushObjectFlag(e.o,e.i),this.assignIndexedValue(r,"["+i+(n?",]":"]"))}return this.assignIndexedValue(r,"[]")}serializeProperty(e,r,a){if(typeof r=="string"){let i=Number(r),n=i>=0&&i.toString()===r||he(r);if(this.isIndexedValueInStack(a)){let l=this.getRefParam(a.i);return this.markRef(e.i),n&&i!==i?this.createObjectAssign(e.i,r,l):this.createArrayAssign(e.i,n?r:'"'+r+'"',l),""}return(n?r:'"'+r+'"')+":"+this.serialize(a)}return"["+this.serialize(r)+"]:"+this.serialize(a)}serializeProperties(e,r){let a=r.s;if(a){let i=r.k,n=r.v;this.stack.push(e.i);let l=this.serializeProperty(e,i[0],n[0]);for(let o=1,u=l;o<a;o++)u=this.serializeProperty(e,i[o],n[o]),l+=(u&&l&&",")+u;return this.stack.pop(),"{"+l+"}"}return"{}"}serializeObject(e){return this.pushObjectFlag(e.o,e.i),this.assignIndexedValue(e.i,this.serializeProperties(e,e.p))}serializeWithObjectAssign(e,r,a){let i=this.serializeProperties(e,r);return i!=="{}"?"Object.assign("+a+","+i+")":a}serializeStringKeyAssignment(e,r,a,i){let n=this.serialize(i),l=Number(a),o=l>=0&&l.toString()===a||he(a);if(this.isIndexedValueInStack(i))o&&l!==l?this.createObjectAssign(e.i,a,n):this.createArrayAssign(e.i,o?a:'"'+a+'"',n);else{let u=this.assignments;this.assignments=r,o&&l!==l?this.createObjectAssign(e.i,a,n):this.createArrayAssign(e.i,o?a:'"'+a+'"',n),this.assignments=u}}serializeAssignment(e,r,a,i){if(typeof a=="string")this.serializeStringKeyAssignment(e,r,a,i);else{let n=this.stack;this.stack=[];let l=this.serialize(i);this.stack=n;let o=this.assignments;this.assignments=r,this.createArrayAssign(e.i,this.serialize(a),l),this.assignments=o}}serializeAssignments(e,r){let a=r.s;if(a){let i=[],n=r.k,l=r.v;this.stack.push(e.i);for(let o=0;o<a;o++)this.serializeAssignment(e,i,n[o],l[o]);return this.stack.pop(),fe(i)}return s}serializeDictionary(e,r){if(e.p)if(this.features&8)r=this.serializeWithObjectAssign(e,e.p,r);else{this.markRef(e.i);let a=this.serializeAssignments(e,e.p);if(a)return"("+this.assignIndexedValue(e.i,r)+","+a+this.getRefParam(e.i)+")"}return this.assignIndexedValue(e.i,r)}serializeNullConstructor(e){return this.pushObjectFlag(e.o,e.i),this.serializeDictionary(e,lr)}serializeDate(e){return this.assignIndexedValue(e.i,'new Date("'+e.s+'")')}serializeRegExp(e){return this.assignIndexedValue(e.i,"/"+e.c+"/"+e.m)}serializeSetItem(e,r){return this.isIndexedValueInStack(r)?(this.markRef(e),this.createAddAssignment(e,this.getRefParam(r.i)),""):this.serialize(r)}serializeSet(e){let r=or,a=e.l,i=e.i;if(a){let n=e.a;this.stack.push(i);let l=this.serializeSetItem(i,n[0]);for(let o=1,u=l;o<a;o++)u=this.serializeSetItem(i,n[o]),l+=(u&&l&&",")+u;this.stack.pop(),l&&(r+="(["+l+"])")}return this.assignIndexedValue(i,r)}serializeMapEntry(e,r,a,i){if(this.isIndexedValueInStack(r)){let n=this.getRefParam(r.i);if(this.markRef(e),this.isIndexedValueInStack(a)){let o=this.getRefParam(a.i);return this.createSetAssignment(e,n,o),""}if(a.t!==4&&a.i!=null&&this.isMarked(a.i)){let o="("+this.serialize(a)+",["+i+","+i+"])";return this.createSetAssignment(e,n,this.getRefParam(a.i)),this.createDeleteAssignment(e,i),o}let l=this.stack;return this.stack=[],this.createSetAssignment(e,n,this.serialize(a)),this.stack=l,""}if(this.isIndexedValueInStack(a)){let n=this.getRefParam(a.i);if(this.markRef(e),r.t!==4&&r.i!=null&&this.isMarked(r.i)){let o="("+this.serialize(r)+",["+i+","+i+"])";return this.createSetAssignment(e,this.getRefParam(r.i),n),this.createDeleteAssignment(e,i),o}let l=this.stack;return this.stack=[],this.createSetAssignment(e,this.serialize(r),n),this.stack=l,""}return"["+this.serialize(r)+","+this.serialize(a)+"]"}serializeMap(e){let r=ur,a=e.e.s,i=e.i,n=e.f,l=this.getRefParam(n.i);if(a){let o=e.e.k,u=e.e.v;this.stack.push(i);let c=this.serializeMapEntry(i,o[0],u[0],l);for(let d=1,m=c;d<a;d++)m=this.serializeMapEntry(i,o[d],u[d],l),c+=(m&&c&&",")+m;this.stack.pop(),c&&(r+="(["+c+"])")}return n.t===26&&(this.markRef(n.i),r="("+this.serialize(n)+","+r+")"),this.assignIndexedValue(i,r)}serializeArrayBuffer(e){let r="new Uint8Array(",a=e.s,i=a.length;if(i){r+="["+a[0];for(let n=1;n<i;n++)r+=","+a[n];r+="]"}return this.assignIndexedValue(e.i,r+").buffer")}serializeTypedArray(e){return this.assignIndexedValue(e.i,"new "+e.c+"("+this.serialize(e.f)+","+e.b+","+e.l+")")}serializeDataView(e){return this.assignIndexedValue(e.i,"new DataView("+this.serialize(e.f)+","+e.b+","+e.l+")")}serializeAggregateError(e){let r=e.i;this.stack.push(r);let a=this.serializeDictionary(e,'new AggregateError([],"'+e.m+'")');return this.stack.pop(),a}serializeError(e){return this.serializeDictionary(e,"new "+ke[e.s]+'("'+e.m+'")')}serializePromise(e){let r,a=e.f,i=e.i,n=e.s?cr:hr;if(this.isIndexedValueInStack(a)){let l=this.getRefParam(a.i);r=n+(e.s?"().then("+this.createFunction([],l)+")":"().catch("+this.createEffectfulFunction([],"throw "+l)+")")}else{this.stack.push(i);let l=this.serialize(a);this.stack.pop(),r=n+"("+l+")"}return this.assignIndexedValue(i,r)}serializeWellKnownSymbol(e){return this.assignIndexedValue(e.i,ct[e.s])}serializeBoxed(e){return this.assignIndexedValue(e.i,"Object("+this.serialize(e.f)+")")}serializePlugin(e){let r=this.plugins;if(r)for(let a=0,i=r.length;a<i;a++){let n=r[a];if(n.tag===e.c)return this.assignIndexedValue(e.i,n.serialize(e.s,this,{id:e.i}))}throw new Ne(e.c)}getConstructor(e){let r=this.serialize(e);return r===this.getRefParam(e.i)?r:"("+r+")"}serializePromiseConstructor(e){return this.assignIndexedValue(e.i,this.getConstructor(e.f)+"()")}serializePromiseResolve(e){return this.getConstructor(e.a[0])+"("+this.getRefParam(e.i)+","+this.serialize(e.a[1])+")"}serializePromiseReject(e){return this.getConstructor(e.a[0])+"("+this.getRefParam(e.i)+","+this.serialize(e.a[1])+")"}serializeSpecialReferenceValue(e){switch(e){case 0:return"[]";case 1:return this.createFunction(["s","f","p"],"((p=new Promise("+this.createEffectfulFunction(["a","b"],"s=a,f=b")+")).s=s,p.f=f,p)");case 2:return this.createEffectfulFunction(["p","d"],'p.s(d),p.status="success",p.value=d;delete p.s;delete p.f');case 3:return this.createEffectfulFunction(["p","d"],'p.f(d),p.status="failure",p.value=d;delete p.s;delete p.f');case 4:return this.createFunction(["b","a","s","l","p","f","e","n"],"(b=[],a=!0,s=!1,l=[],p=0,f="+this.createEffectfulFunction(["v","m","x"],"for(x=0;x<p;x++)l[x]&&l[x][m](v)")+",n="+this.createEffectfulFunction(["o","x","z","c"],'for(x=0,z=b.length;x<z;x++)(c=b[x],(!a&&x===z-1)?o[s?"return":"throw"](c):o.next(c))')+",e="+this.createFunction(["o","t"],"(a&&(l[t=p++]=o),n(o),"+this.createEffectfulFunction([],"a&&(l[t]=void 0)")+")")+",{__SEROVAL_STREAM__:!0,on:"+this.createFunction(["o"],"e(o)")+",next:"+this.createEffectfulFunction(["v"],'a&&(b.push(v),f(v,"next"))')+",throw:"+this.createEffectfulFunction(["v"],'a&&(b.push(v),f(v,"throw"),a=s=!1,l.length=0)')+",return:"+this.createEffectfulFunction(["v"],'a&&(b.push(v),f(v,"return"),a=!1,s=!0,l.length=0)')+"})");case 5:return this.createFunction(["a","s"],"((s=(a=new AbortController).signal).a=a,s)");case 6:return this.createEffectfulFunction(["s","r"],"s.a.abort(r);delete s.a");default:return""}}serializeSpecialReference(e){return this.assignIndexedValue(e.i,this.serializeSpecialReferenceValue(e.s))}serializeIteratorFactory(e){let r="",a=!1;return e.f.t!==4&&(this.markRef(e.f.i),r="("+this.serialize(e.f)+",",a=!0),r+=this.assignIndexedValue(e.i,this.createFunction(["s"],this.createFunction(["i","c","d","t"],"(i=0,t={["+this.getRefParam(e.f.i)+"]:"+this.createFunction([],"t")+",next:"+this.createEffectfulFunction([],"if(i>s.d)return{done:!0,value:void 0};if(d=s.v[c=i++],c===s.t)throw d;return{done:c===s.d,value:d}")+"})"))),a&&(r+=")"),r}serializeIteratorFactoryInstance(e){return this.getConstructor(e.a[0])+"("+this.serialize(e.a[1])+")"}serializeAsyncIteratorFactory(e){let r=e.a[0],a=e.a[1],i="";r.t!==4&&(this.markRef(r.i),i+="("+this.serialize(r)),a.t!==4&&(this.markRef(a.i),i+=(i?",":"(")+this.serialize(a)),i&&(i+=",");let n=this.assignIndexedValue(e.i,this.createFunction(["s"],this.createFunction(["b","c","p","d","e","t","f"],"(b=[],c=0,p=[],d=-1,e=!1,f="+this.createEffectfulFunction(["i","l"],"for(i=0,l=p.length;i<l;i++)p[i].s({done:!0,value:void 0})")+",s.on({next:"+this.createEffectfulFunction(["v","t"],"if(t=p.shift())t.s({done:!1,value:v});b.push(v)")+",throw:"+this.createEffectfulFunction(["v","t"],"if(t=p.shift())t.f(v);f(),d=b.length,e=!0,b.push(v)")+",return:"+this.createEffectfulFunction(["v","t"],"if(t=p.shift())t.s({done:!0,value:v});f(),d=b.length,b.push(v)")+"}),t={["+this.getRefParam(a.i)+"]:"+this.createFunction([],"t")+",next:"+this.createEffectfulFunction(["i","t","v"],"if(d===-1){return((i=c++)>=b.length)?(p.push(t="+this.getRefParam(r.i)+"()),t):{done:!1,value:b[i]}}if(c>d)return{done:!0,value:void 0};if(v=b[i=c++],i!==d)return{done:!1,value:v};if(e)throw v;return{done:!0,value:v}")+"})")));return i?i+n+")":n}serializeAsyncIteratorFactoryInstance(e){return this.getConstructor(e.a[0])+"("+this.serialize(e.a[1])+")"}serializeStreamConstructor(e){let r=this.assignIndexedValue(e.i,this.getConstructor(e.f)+"()"),a=e.a.length;if(a){let i=this.serialize(e.a[0]);for(let n=1;n<a;n++)i+=","+this.serialize(e.a[n]);return"("+r+","+i+","+this.getRefParam(e.i)+")"}return r}serializeStreamNext(e){return this.getRefParam(e.i)+".next("+this.serialize(e.f)+")"}serializeStreamThrow(e){return this.getRefParam(e.i)+".throw("+this.serialize(e.f)+")"}serializeStreamReturn(e){return this.getRefParam(e.i)+".return("+this.serialize(e.f)+")"}serializeAbortSignalSync(e){return this.assignIndexedValue(e.i,"AbortSignal.abort("+this.serialize(e.f)+")")}serializeAbortSignalConstructor(e){return this.assignIndexedValue(e.i,this.getConstructor(e.f)+"()")}serializeAbortSignalAbort(e){return this.getConstructor(e.a[0])+"("+this.getRefParam(e.i)+","+this.serialize(e.a[1])+")"}serialize(e){try{switch(e.t){case 2:return ft[e.s];case 0:return""+e.s;case 1:return'"'+e.s+'"';case 3:return e.s+"n";case 4:return this.getRefParam(e.i);case 18:return this.serializeReference(e);case 9:return this.serializeArray(e);case 10:return this.serializeObject(e);case 11:return this.serializeNullConstructor(e);case 5:return this.serializeDate(e);case 6:return this.serializeRegExp(e);case 7:return this.serializeSet(e);case 8:return this.serializeMap(e);case 19:return this.serializeArrayBuffer(e);case 16:case 15:return this.serializeTypedArray(e);case 20:return this.serializeDataView(e);case 14:return this.serializeAggregateError(e);case 13:return this.serializeError(e);case 12:return this.serializePromise(e);case 17:return this.serializeWellKnownSymbol(e);case 21:return this.serializeBoxed(e);case 22:return this.serializePromiseConstructor(e);case 23:return this.serializePromiseResolve(e);case 24:return this.serializePromiseReject(e);case 25:return this.serializePlugin(e);case 26:return this.serializeSpecialReference(e);case 27:return this.serializeIteratorFactory(e);case 28:return this.serializeIteratorFactoryInstance(e);case 29:return this.serializeAsyncIteratorFactory(e);case 30:return this.serializeAsyncIteratorFactoryInstance(e);case 31:return this.serializeStreamConstructor(e);case 32:return this.serializeStreamNext(e);case 33:return this.serializeStreamThrow(e);case 34:return this.serializeStreamReturn(e);case 36:return this.serializeAbortSignalAbort(e);case 35:return this.serializeAbortSignalConstructor(e);case 37:return this.serializeAbortSignalSync(e);default:throw new je(e)}}catch(r){throw new Bt(r)}}},pr=class extends dr{constructor(t){super(t),this.mode="cross",this.scopeId=t.scopeId}getRefParam(t){return j+"["+t+"]"}assignIndexedValue(t,e){return this.getRefParam(t)+"="+e}serializeTop(t){let e=this.serialize(t),r=t.i;if(r==null)return e;let a=this.resolvePatches(),i=this.getRefParam(r),n=this.scopeId==null?"":j,l=a?"("+e+","+a+i+")":e;if(n==="")return t.t===10&&!a?"("+l+")":l;let o=this.scopeId==null?"()":"("+j+'["'+g(this.scopeId)+'"])';return"("+this.createFunction([n],l)+")"+o}},gr=class extends rr{parseItems(t){let e=[];for(let r=0,a=t.length;r<a;r++)r in t&&(e[r]=this.parse(t[r]));return e}parseArray(t,e){return Ft(t,e,this.parseItems(e))}parseProperties(t){let e=Object.entries(t),r=[],a=[];for(let n=0,l=e.length;n<l;n++)r.push(g(e[n][0])),a.push(this.parse(e[n][1]));let i=Symbol.iterator;return i in t&&(r.push(this.parseWellKnownSymbol(i)),a.push(Oe(this.parseIteratorFactory(),this.parse(Te(t))))),i=Symbol.asyncIterator,i in t&&(r.push(this.parseWellKnownSymbol(i)),a.push($e(this.parseAsyncIteratorFactory(),this.parse(F())))),i=Symbol.toStringTag,i in t&&(r.push(this.parseWellKnownSymbol(i)),a.push(q(t[i]))),i=Symbol.isConcatSpreadable,i in t&&(r.push(this.parseWellKnownSymbol(i)),a.push(t[i]?B:W)),{k:r,v:a,s:r.length}}parsePlainObject(t,e,r){return this.createObjectNode(t,e,r,this.parseProperties(e))}parseBoxed(t,e){return Ct(t,this.parse(e.valueOf()))}parseTypedArray(t,e){return Ot(t,e,this.parse(e.buffer))}parseBigIntTypedArray(t,e){return $t(t,e,this.parse(e.buffer))}parseDataView(t,e){return Vt(t,e,this.parse(e.buffer))}parseError(t,e){let r=ue(e,this.features);return jt(t,e,r?this.parseProperties(r):s)}parseAggregateError(t,e){let r=ue(e,this.features);return Nt(t,e,r?this.parseProperties(r):s)}parseMap(t,e){let r=[],a=[];for(let[i,n]of e.entries())r.push(this.parse(i)),a.push(this.parse(n));return this.createMapNode(t,r,a,e.size)}parseSet(t,e){let r=[];for(let a of e.keys())r.push(this.parse(a));return Tt(t,e.size,r)}parsePlugin(t,e){let r=this.plugins;if(r)for(let a=0,i=r.length;a<i;a++){let n=r[a];if(n.parse.sync&&n.test(e))return Ce(t,n.tag,n.parse.sync(e,this,{id:t}))}}parseStream(t,e){return Ve(t,this.parseSpecialReference(4),[])}parsePromise(t,e){return this.createPromiseConstructorNode(t)}parseAbortSignalSync(t,e){return f(37,t,s,s,s,s,s,s,s,this.parse(e.reason),s,s)}parseAbortSignal(t,e){return e.aborted?this.parseAbortSignalSync(t,e):this.createAbortSignalConstructorNode(t)}parseObject(t,e){if(Array.isArray(e))return this.parseArray(t,e);if(Jt(e))return this.parseStream(t,e);let r=e.constructor;if(r===Xt)return this.parse(e.replacement);let a=this.parsePlugin(t,e);if(a)return a;switch(r){case Object:return this.parsePlainObject(t,e,!1);case void 0:return this.parsePlainObject(t,e,!0);case Date:return It(t,e);case RegExp:return Et(t,e);case Error:case EvalError:case RangeError:case ReferenceError:case SyntaxError:case TypeError:case URIError:return this.parseError(t,e);case Number:case Boolean:case String:case BigInt:return this.parseBoxed(t,e);case ArrayBuffer:return xt(t,e);case Int8Array:case Int16Array:case Int32Array:case Uint8Array:case Uint16Array:case Uint32Array:case Uint8ClampedArray:case Float32Array:case Float64Array:return this.parseTypedArray(t,e);case DataView:return this.parseDataView(t,e);case Map:return this.parseMap(t,e);case Set:return this.parseSet(t,e)}if(r===Promise||e instanceof Promise)return this.parsePromise(t,e);let i=this.features;if(i&32&&typeof AbortSignal<"u"&&r===AbortSignal)return this.parseAbortSignal(t,e);if(i&16)switch(r){case BigInt64Array:case BigUint64Array:return this.parseBigIntTypedArray(t,e)}if(i&1&&typeof AggregateError<"u"&&(r===AggregateError||e instanceof AggregateError))return this.parseAggregateError(t,e);if(e instanceof Error)return this.parseError(t,e);if(Symbol.iterator in e||Symbol.asyncIterator in e)return this.parsePlainObject(t,e,!!r);throw new N(e)}parseFunction(t){let e=this.getReference(t);if(e.type!==0)return e.value;let r=this.parsePlugin(e.value,t);if(r)return r;throw new N(t)}parse(t){try{switch(typeof t){case"boolean":return t?B:W;case"undefined":return gt;case"string":return q(t);case"number":return wt(t);case"bigint":return At(t);case"object":{if(t){let e=this.getReference(t);return e.type===0?this.parseObject(e.value,t):e.value}return mt}case"symbol":return this.parseWellKnownSymbol(t);case"function":return this.parseFunction(t);default:throw new N(t)}}catch(e){throw new _t(e)}}},mr=class extends gr{constructor(e){super(e),this.alive=!0,this.pending=0,this.initial=!0,this.buffer=[],this.onParseCallback=e.onParse,this.onErrorCallback=e.onError,this.onDoneCallback=e.onDone}onParseInternal(e,r){try{this.onParseCallback(e,r)}catch(a){this.onError(a)}}flush(){for(let e=0,r=this.buffer.length;e<r;e++)this.onParseInternal(this.buffer[e],!1)}onParse(e){this.initial?this.buffer.push(e):this.onParseInternal(e,!1)}onError(e){if(this.onErrorCallback)this.onErrorCallback(e);else throw e}onDone(){this.onDoneCallback&&this.onDoneCallback()}pushPendingState(){this.pending++}popPendingState(){--this.pending<=0&&this.onDone()}parseProperties(e){let r=Object.entries(e),a=[],i=[];for(let l=0,o=r.length;l<o;l++)a.push(g(r[l][0])),i.push(this.parse(r[l][1]));let n=Symbol.iterator;return n in e&&(a.push(this.parseWellKnownSymbol(n)),i.push(Oe(this.parseIteratorFactory(),this.parse(Te(e))))),n=Symbol.asyncIterator,n in e&&(a.push(this.parseWellKnownSymbol(n)),i.push($e(this.parseAsyncIteratorFactory(),this.parse(Qt(e))))),n=Symbol.toStringTag,n in e&&(a.push(this.parseWellKnownSymbol(n)),i.push(q(e[n]))),n=Symbol.isConcatSpreadable,n in e&&(a.push(this.parseWellKnownSymbol(n)),i.push(e[n]?B:W)),{k:a,v:i,s:a.length}}parsePromise(e,r){return r.then(a=>{let i=this.parseWithError(a);i&&this.onParse(f(23,e,s,s,s,s,s,s,[this.parseSpecialReference(2),i],s,s,s)),this.popPendingState()},a=>{if(this.alive){let i=this.parseWithError(a);i&&this.onParse(f(24,e,s,s,s,s,s,s,[this.parseSpecialReference(3),i],s,s,s))}this.popPendingState()}),this.pushPendingState(),this.createPromiseConstructorNode(e)}parsePlugin(e,r){let a=this.plugins;if(a)for(let i=0,n=a.length;i<n;i++){let l=a[i];if(l.parse.stream&&l.test(r))return Ce(e,l.tag,l.parse.stream(r,this,{id:e}))}return s}parseStream(e,r){let a=Ve(e,this.parseSpecialReference(4),[]);return this.pushPendingState(),r.on({next:i=>{if(this.alive){let n=this.parseWithError(i);n&&this.onParse(Dt(e,n))}},throw:i=>{if(this.alive){let n=this.parseWithError(i);n&&this.onParse(Mt(e,n))}this.popPendingState()},return:i=>{if(this.alive){let n=this.parseWithError(i);n&&this.onParse(Ut(e,n))}this.popPendingState()}}),a}handleAbortSignal(e,r){if(this.alive){let a=this.parseWithError(r.reason);a&&this.onParse(f(36,e,s,s,s,s,s,s,[this.parseSpecialReference(6),a],s,s,s))}this.popPendingState()}parseAbortSignal(e,r){return r.aborted?this.parseAbortSignalSync(e,r):(this.pushPendingState(),r.addEventListener("abort",this.handleAbortSignal.bind(this,e,r),{once:!0}),this.createAbortSignalConstructorNode(e))}parseWithError(e){try{return this.parse(e)}catch(r){return this.onError(r),s}}start(e){let r=this.parseWithError(e);r&&(this.onParseInternal(r,!0),this.initial=!1,this.flush(),this.pending<=0&&this.destroy())}destroy(){this.alive&&(this.onDone(),this.alive=!1)}isAlive(){return this.alive}},yr=class extends mr{constructor(){super(...arguments),this.mode="cross"}};function br(t,e){let r=xe(e.plugins),a=new yr({plugins:r,refs:e.refs,disabledFeatures:e.disabledFeatures,onParse(i,n){let l=new pr({plugins:r,features:a.features,scopeId:e.scopeId,markedRefs:a.marked}),o;try{o=l.serializeTop(i)}catch(u){e.onError&&e.onError(u);return}e.onSerialize(o,n)},onError:e.onError,onDone:e.onDone});return a.start(t),a.destroy.bind(a)}var zr=class extends ar{constructor(t){super(t),this.mode="vanilla",this.marked=new Set(t.markedRefs)}assignIndexedValue(t,e){return this.marked.has(t)&&this.refs.set(t,e),e}};function de(t,e={}){let r=xe(e.plugins);return new zr({plugins:r,markedRefs:t.m}).deserialize(t.t)}function T(t){return{detail:t.detail,bubbles:t.bubbles,cancelable:t.cancelable,composed:t.composed}}var Sr={tag:"seroval-plugins/web/CustomEvent",test(t){return typeof CustomEvent>"u"?!1:t instanceof CustomEvent},parse:{sync(t,e){return{type:e.parse(t.type),options:e.parse(T(t))}},async async(t,e){return{type:await e.parse(t.type),options:await e.parse(T(t))}},stream(t,e){return{type:e.parse(t.type),options:e.parse(T(t))}}},serialize(t,e){return"new CustomEvent("+e.serialize(t.type)+","+e.serialize(t.options)+")"},deserialize(t,e){return new CustomEvent(e.deserialize(t.type),e.deserialize(t.options))}},K=Sr,vr={tag:"seroval-plugins/web/DOMException",test(t){return typeof DOMException>"u"?!1:t instanceof DOMException},parse:{sync(t,e){return{name:e.parse(t.name),message:e.parse(t.message)}},async async(t,e){return{name:await e.parse(t.name),message:await e.parse(t.message)}},stream(t,e){return{name:e.parse(t.name),message:e.parse(t.message)}}},serialize(t,e){return"new DOMException("+e.serialize(t.message)+","+e.serialize(t.name)+")"},deserialize(t,e){return new DOMException(e.deserialize(t.message),e.deserialize(t.name))}},X=vr;function D(t){return{bubbles:t.bubbles,cancelable:t.cancelable,composed:t.composed}}var wr={tag:"seroval-plugins/web/Event",test(t){return typeof Event>"u"?!1:t instanceof Event},parse:{sync(t,e){return{type:e.parse(t.type),options:e.parse(D(t))}},async async(t,e){return{type:await e.parse(t.type),options:await e.parse(D(t))}},stream(t,e){return{type:e.parse(t.type),options:e.parse(D(t))}}},serialize(t,e){return"new Event("+e.serialize(t.type)+","+e.serialize(t.options)+")"},deserialize(t,e){return new Event(e.deserialize(t.type),e.deserialize(t.options))}},Y=wr,Ar={tag:"seroval-plugins/web/File",test(t){return typeof File>"u"?!1:t instanceof File},parse:{async async(t,e){return{name:await e.parse(t.name),options:await e.parse({type:t.type,lastModified:t.lastModified}),buffer:await e.parse(await t.arrayBuffer())}}},serialize(t,e){return"new File(["+e.serialize(t.buffer)+"],"+e.serialize(t.name)+","+e.serialize(t.options)+")"},deserialize(t,e){return new File([e.deserialize(t.buffer)],e.deserialize(t.name),e.deserialize(t.options))}},Rr=Ar;function M(t){let e=[];return t.forEach((r,a)=>{e.push([a,r])}),e}var E={},Ir={tag:"seroval-plugins/web/FormDataFactory",test(t){return t===E},parse:{sync(){},async async(){return await Promise.resolve(void 0)},stream(){}},serialize(t,e){return e.createEffectfulFunction(["e","f","i","s","t"],"f=new FormData;for(i=0,s=e.length;i<s;i++)f.append((t=e[i])[0],t[1]);return f")},deserialize(){return E}},Er={tag:"seroval-plugins/web/FormData",extends:[Rr,Ir],test(t){return typeof FormData>"u"?!1:t instanceof FormData},parse:{sync(t,e){return{factory:e.parse(E),entries:e.parse(M(t))}},async async(t,e){return{factory:await e.parse(E),entries:await e.parse(M(t))}},stream(t,e){return{factory:e.parse(E),entries:e.parse(M(t))}}},serialize(t,e){return"("+e.serialize(t.factory)+")("+e.serialize(t.entries)+")"},deserialize(t,e){let r=new FormData,a=e.deserialize(t.entries);for(let i=0,n=a.length;i<n;i++){let l=a[i];r.append(l[0],l[1])}return r}},G=Er;function U(t){let e=[];return t.forEach((r,a)=>{e.push([a,r])}),e}var xr={tag:"seroval-plugins/web/Headers",test(t){return typeof Headers>"u"?!1:t instanceof Headers},parse:{sync(t,e){return e.parse(U(t))},async async(t,e){return await e.parse(U(t))},stream(t,e){return e.parse(U(t))}},serialize(t,e){return"new Headers("+e.serialize(t)+")"},deserialize(t,e){return new Headers(e.deserialize(t))}},P=xr,x={},Pr={tag:"seroval-plugins/web/ReadableStreamFactory",test(t){return t===x},parse:{sync(){},async async(){return await Promise.resolve(void 0)},stream(){}},serialize(t,e){return e.createFunction(["d"],"new ReadableStream({start:"+e.createEffectfulFunction(["c"],"d.on({next:"+e.createEffectfulFunction(["v"],"c.enqueue(v)")+",throw:"+e.createEffectfulFunction(["v"],"c.error(v)")+",return:"+e.createEffectfulFunction([],"c.close()")+"})")+"})")},deserialize(){return x}};function pe(t){let e=F(),r=t.getReader();async function a(){try{let i=await r.read();i.done?e.return(i.value):(e.next(i.value),await a())}catch(i){e.throw(i)}}return a().catch(()=>{}),e}var kr={tag:"seroval/plugins/web/ReadableStream",extends:[Pr],test(t){return typeof ReadableStream>"u"?!1:t instanceof ReadableStream},parse:{sync(t,e){return{factory:e.parse(x),stream:e.parse(F())}},async async(t,e){return{factory:await e.parse(x),stream:await e.parse(pe(t))}},stream(t,e){return{factory:e.parse(x),stream:e.parse(pe(t))}}},serialize(t,e){return"("+e.serialize(t.factory)+")("+e.serialize(t.stream)+")"},deserialize(t,e){let r=e.deserialize(t.stream);return new ReadableStream({start(a){r.on({next(i){a.enqueue(i)},throw(i){a.error(i)},return(){a.close()}})}})}},k=kr;function ge(t,e){return{body:e,cache:t.cache,credentials:t.credentials,headers:t.headers,integrity:t.integrity,keepalive:t.keepalive,method:t.method,mode:t.mode,redirect:t.redirect,referrer:t.referrer,referrerPolicy:t.referrerPolicy}}var Fr={tag:"seroval-plugins/web/Request",extends:[k,P],test(t){return typeof Request>"u"?!1:t instanceof Request},parse:{async async(t,e){return{url:await e.parse(t.url),options:await e.parse(ge(t,t.body?await t.clone().arrayBuffer():null))}},stream(t,e){return{url:e.parse(t.url),options:e.parse(ge(t,t.clone().body))}}},serialize(t,e){return"new Request("+e.serialize(t.url)+","+e.serialize(t.options)+")"},deserialize(t,e){return new Request(e.deserialize(t.url),e.deserialize(t.options))}},Z=Fr;function me(t){return{headers:t.headers,status:t.status,statusText:t.statusText}}var Cr={tag:"seroval-plugins/web/Response",extends:[k,P],test(t){return typeof Response>"u"?!1:t instanceof Response},parse:{async async(t,e){return{body:await e.parse(t.body?await t.clone().arrayBuffer():null),options:await e.parse(me(t))}},stream(t,e){return{body:e.parse(t.clone().body),options:e.parse(me(t))}}},serialize(t,e){return"new Response("+e.serialize(t.body)+","+e.serialize(t.options)+")"},deserialize(t,e){return new Response(e.deserialize(t.body),e.deserialize(t.options))}},J=Cr,Or={tag:"seroval-plugins/web/URLSearchParams",test(t){return typeof URLSearchParams>"u"?!1:t instanceof URLSearchParams},parse:{sync(t,e){return e.parse(t.toString())},async async(t,e){return await e.parse(t.toString())},stream(t,e){return e.parse(t.toString())}},serialize(t,e){return"new URLSearchParams("+e.serialize(t)+")"},deserialize(t,e){return new URLSearchParams(e.deserialize(t))}},Q=Or,$r={tag:"seroval-plugins/web/URL",test(t){return typeof URL>"u"?!1:t instanceof URL},parse:{sync(t,e){return e.parse(t.href)},async async(t,e){return await e.parse(t.href)},stream(t,e){return e.parse(t.href)}},serialize(t,e){return"new URL("+e.serialize(t)+")"},deserialize(t,e){return new URL(e.deserialize(t))}},ee=$r;const L="Invariant Violation",{setPrototypeOf:Vr=function(t,e){return t.__proto__=e,t}}=Object;class ae extends Error{framesToPop=1;name=L;constructor(e=L){super(typeof e=="number"?`${L}: ${e} (see https://github.com/apollographql/invariant-packages)`:e),Vr(this,ae.prototype)}}function jr(t,e){if(!t)throw new ae(e)}const A={NORMAL:0,WILDCARD:1,PLACEHOLDER:2};function Nr(t={}){const e={options:t,rootNode:De(),staticRoutesMap:{}},r=a=>t.strictTrailingSlash?a:a.replace(/\/$/,"")||"/";if(t.routes)for(const a in t.routes)ye(e,r(a),t.routes[a]);return{ctx:e,lookup:a=>Tr(e,r(a)),insert:(a,i)=>ye(e,r(a),i),remove:a=>Dr(e,r(a))}}function Tr(t,e){const r=t.staticRoutesMap[e];if(r)return r.data;const a=e.split("/"),i={};let n=!1,l=null,o=t.rootNode,u=null;for(let c=0;c<a.length;c++){const d=a[c];o.wildcardChildNode!==null&&(l=o.wildcardChildNode,u=a.slice(c).join("/"));const m=o.children.get(d);if(m===void 0){if(o&&o.placeholderChildren.length>1){const b=a.length-c;o=o.placeholderChildren.find(h=>h.maxDepth===b)||null}else o=o.placeholderChildren[0]||null;if(!o)break;o.paramName&&(i[o.paramName]=d),n=!0}else o=m}return(o===null||o.data===null)&&l!==null&&(o=l,i[o.paramName||"_"]=u,n=!0),o?n?{...o.data,params:n?i:void 0}:o.data:null}function ye(t,e,r){let a=!0;const i=e.split("/");let n=t.rootNode,l=0;const o=[n];for(const u of i){let c;if(c=n.children.get(u))n=c;else{const d=Mr(u);c=De({type:d,parent:n}),n.children.set(u,c),d===A.PLACEHOLDER?(c.paramName=u==="*"?`_${l++}`:u.slice(1),n.placeholderChildren.push(c),a=!1):d===A.WILDCARD&&(n.wildcardChildNode=c,c.paramName=u.slice(3)||"_",a=!1),o.push(c),n=c}}for(const[u,c]of o.entries())c.maxDepth=Math.max(o.length-u,c.maxDepth||0);return n.data=r,a===!0&&(t.staticRoutesMap[e]=n),n}function Dr(t,e){let r=!1;const a=e.split("/");let i=t.rootNode;for(const n of a)if(i=i.children.get(n),!i)return r;if(i.data){const n=a.at(-1)||"";i.data=null,Object.keys(i.children).length===0&&i.parent&&(i.parent.children.delete(n),i.parent.wildcardChildNode=null,i.parent.placeholderChildren=[]),r=!0}return r}function De(t={}){return{type:t.type||A.NORMAL,maxDepth:0,parent:t.parent||null,children:new Map,data:t.data||null,paramName:t.paramName||null,wildcardChildNode:null,placeholderChildren:[]}}function Mr(t){return t.startsWith("**")?A.WILDCARD:t[0]===":"||t==="*"?A.PLACEHOLDER:A.NORMAL}const Me=[{page:!0,$component:{src:"src/routes/[...404].tsx?pick=default&pick=$css",build:()=>import("../_...404_.js"),import:()=>import("../_...404_.js")},path:"/*404",filePath:"/var/home/v/lab/solid/src/routes/[...404].tsx"},{page:!0,$component:{src:"src/routes/about.tsx?pick=default&pick=$css",build:()=>import("../about.js"),import:()=>import("../about.js")},path:"/about",filePath:"/var/home/v/lab/solid/src/routes/about.tsx"},{page:!0,$component:{src:"src/routes/index.tsx?pick=default&pick=$css",build:()=>import("../index.js"),import:()=>import("../index.js")},path:"/",filePath:"/var/home/v/lab/solid/src/routes/index.tsx"}],Ur=Lr(Me.filter(t=>t.page));function Lr(t){function e(r,a,i,n){const l=Object.values(r).find(o=>i.startsWith(o.id+"/"));return l?(e(l.children||(l.children=[]),a,i.slice(l.id.length)),r):(r.push({...a,id:i,path:i.replace(/\([^)/]+\)/g,"").replace(/\/+/g,"/")}),r)}return t.sort((r,a)=>r.path.length-a.path.length).reduce((r,a)=>e(r,a,a.path,a.path),[])}function _r(t){return t.$HEAD||t.$GET||t.$POST||t.$PUT||t.$PATCH||t.$DELETE}Nr({routes:Me.reduce((t,e)=>{if(!_r(e))return t;let r=e.path.replace(/\([^)/]+\)/g,"").replace(/\/+/g,"/").replace(/\*([^/]*)/g,(a,i)=>`**:${i}`).split("/").map(a=>a.startsWith(":")||a.startsWith("*")?a:encodeURIComponent(a)).join("/");if(/:[^/]*\?/g.test(r))throw new Error(`Optional parameters are not supported in API routes: ${r}`);if(t[r])throw new Error(`Duplicate API routes for "${r}" found at "${t[r].route.path}" and "${e.path}"`);return t[r]={route:e},t},{})});function Br(t){t.forEach(e=>{if(!e.attrs.href)return;let r=document.head.querySelector(`link[href="${e.attrs.href}"]`);r||(r=document.createElement("link"),r.setAttribute("rel","preload"),r.setAttribute("as","style"),r.setAttribute("href",e.attrs.href),document.head.appendChild(r))})}var Wr=" ";const qr={style:t=>O("style",t.attrs,()=>t.children,!0),link:t=>O("link",t.attrs,void 0,!0),script:t=>t.attrs.src?O("script",He(()=>t.attrs,{get id(){return t.key}}),()=>Ke(Wr),!0):null,noscript:t=>O("noscript",t.attrs,()=>qe(t.children),!0)};function Hr(t,e){let{tag:r,attrs:{key:a,...i}={key:void 0},children:n}=t;return qr[r]({attrs:{...i,nonce:e},key:a,children:n})}function Kr(t,e,r,a="default"){return Be(async()=>{{const n=(await t.import())[a],o=(await e.inputs?.[t.src].assets()).filter(c=>c.tag==="style"||c.attrs.rel==="stylesheet");return typeof window<"u"&&Br(o),{default:c=>[...o.map(d=>Hr(d)),We(n,c)]}}})}function Ue(){function t(r){return{...r,...r.$$route?r.$$route.require().route:void 0,info:{...r.$$route?r.$$route.require().route.info:{},filesystem:!0},component:r.$component&&Kr(r.$component,globalThis.MANIFEST.client,globalThis.MANIFEST.ssr),children:r.children?r.children.map(t):void 0}}return Ur.map(t)}let be;const ys=Ye?()=>Xe().routes:()=>be||(be=Ue());function Xr(t){const e=Ze(t.nativeEvent,"flash");if(e)try{let r=JSON.parse(e);if(!r||!r.result)return;const a=[...r.input.slice(0,-1),new Map(r.input[r.input.length-1])],i=r.error?new Error(r.result):r.result;return{input:a,url:r.url,pending:!1,result:r.thrown?void 0:i,error:r.thrown?i:void 0}}catch(r){console.error(r)}finally{Je(t.nativeEvent,"flash","",{maxAge:0})}}async function Yr(t){const e=globalThis.MANIFEST.client;return globalThis.MANIFEST.ssr,t.response.headers.set("Content-Type","text/html"),Object.assign(t,{manifest:await e.json(),assets:[...await e.inputs[e.handler].assets()],router:{submission:Xr(t)},routes:Ue(),complete:!1,$islands:new Set})}const Gr=new Set([301,302,303,307,308]);function Zr(t){return t.status&&Gr.has(t.status)?t.status:302}const Jr={"src_backend_ts--foo_action":{functionName:"foo_action",importer:()=>import("./backend-CglC91-y.js")}};function Qr(t){const e=new TextEncoder().encode(t),r=e.length,a=r.toString(16),i="00000000".substring(0,8-a.length)+a,n=new TextEncoder().encode(`;0x${i};`),l=new Uint8Array(12+r);return l.set(n),l.set(e,12),l}function ze(t,e){return new ReadableStream({start(r){br(e,{scopeId:t,plugins:[K,X,Y,G,P,k,Z,J,Q,ee],onSerialize(a,i){r.enqueue(Qr(i?`(${nt(t)},${a})`:a))},onDone(){r.close()},onError(a){r.error(a)}})}})}async function es(t){const e=Qe(t),r=e.request,a=r.headers.get("X-Server-Id"),i=r.headers.get("X-Server-Instance"),n=r.headers.has("X-Single-Flight"),l=new URL(r.url);let o,u;if(a)jr(typeof a=="string","Invalid server function"),[o,u]=a.split("#");else if(o=l.searchParams.get("id"),u=l.searchParams.get("name"),!o||!u)return new Response(null,{status:404});const c=Jr[o];let d;if(!c)return new Response(null,{status:404});d=await c.importer();const m=d[c.functionName];let b=[];if(!i||t.method==="GET"){const h=l.searchParams.get("args");if(h){const p=JSON.parse(h);(p.t?de(p,{plugins:[K,X,Y,G,P,k,Z,J,Q,ee]}):p).forEach(C=>b.push(C))}}if(t.method==="POST"){const h=r.headers.get("content-type"),p=t.node.req,C=p instanceof ReadableStream,Le=p.body instanceof ReadableStream,ie=C&&p.locked||Le&&p.body.locked,ne=C?p:p.body;if(h?.startsWith("multipart/form-data")||h?.startsWith("application/x-www-form-urlencoded"))b.push(await(ie?r:new Request(r,{...r,body:ne})).formData());else if(h?.startsWith("application/json")){const _e=ie?r:new Request(r,{...r,body:ne});b=de(await _e.json(),{plugins:[K,X,Y,G,P,k,Z,J,Q,ee]})}}try{let h=await Ae(e,async()=>(we.context={event:e},e.locals.serverFunctionMeta={id:o+"#"+u},m(...b)));if(n&&i&&(h=await ve(e,h)),h instanceof Response){if(h.headers&&h.headers.has("X-Content-Raw"))return h;i&&(h.headers&&le(t,h.headers),h.status&&(h.status<300||h.status>=400)&&oe(t,h.status),h.customBody?h=await h.customBody():h.body==null&&(h=null))}return i?($(t,"content-type","text/javascript"),ze(i,h)):Se(h,r,b)}catch(h){if(h instanceof Response)n&&i&&(h=await ve(e,h)),h.headers&&le(t,h.headers),h.status&&(!i||h.status<300||h.status>=400)&&oe(t,h.status),h.customBody?h=h.customBody():h.body==null&&(h=null),$(t,"X-Error","true");else if(i){const p=h instanceof Error?h.message:typeof h=="string"?h:"true";$(t,"X-Error",p.replace(/[\r\n]+/g,""))}else h=Se(h,r,b,!0);return i?($(t,"content-type","text/javascript"),ze(i,h)):h}}function Se(t,e,r,a){const i=new URL(e.url),n=t instanceof Error;let l=302,o;return t instanceof Response?(o=new Headers(t.headers),t.headers.has("Location")&&(o.set("Location",new URL(t.headers.get("Location"),i.origin+"").toString()),l=Zr(t))):o=new Headers({Location:new URL(e.headers.get("referer")).toString()}),t&&o.append("Set-Cookie",`flash=${encodeURIComponent(JSON.stringify({url:i.pathname+i.search,result:n?t.message:t,thrown:a,error:n,input:[...r.slice(0,-1),[...r[r.length-1].entries()]]}))}; Secure; HttpOnly;`),new Response(null,{status:l,headers:o})}let _;function ts(t){const e=new Headers(t.request.headers),r=tt(t.nativeEvent),a=t.response.headers.getSetCookie();e.delete("cookie");let i=!1;return t.nativeEvent.node?.req&&(i=!0,t.nativeEvent.node.req.headers.cookie=""),a.forEach(n=>{if(!n)return;const l=n.split(";")[0],[o,u]=l.split("=");o&&u&&(r[o]=u)}),Object.entries(r).forEach(([n,l])=>{e.append("cookie",`${n}=${l}`),i&&(t.nativeEvent.node.req.headers.cookie+=`${n}=${l};`)}),e}async function ve(t,e){let r,a=new URL(t.request.headers.get("referer")).toString();e instanceof Response&&(e.headers.has("X-Revalidate")&&(r=e.headers.get("X-Revalidate").split(",")),e.headers.has("Location")&&(a=new URL(e.headers.get("Location"),new URL(t.request.url).origin+"").toString()));const i=et(t);return i.request=new Request(a,{headers:ts(t)}),await Ae(i,async()=>{await Yr(i),_||(_=(await import("./app-BQX5r7Jd.js")).default),i.router.dataOnly=r||!0,i.router.previousUrl=t.request.headers.get("referer");try{Ge(()=>{we.context.event=i,_()})}catch(o){console.log(o)}const n=i.router.data;if(!n)return e;let l=!1;for(const o in n)n[o]===void 0?delete n[o]:l=!0;return l&&(e instanceof Response?e.customBody&&(n._$value=e.customBody()):(n._$value=e,e=new Response(null,{status:200})),e.customBody=()=>n,e.headers.set("X-Single-Flight","true")),e})}const bs=rt(es);export{ys as F,bs as h};
