import{ssrElement as L,escape as E,mergeProps as ee,ssr as w,getRequestEvent as N,isServer as k,renderToString as te,renderToStream as re,createComponent as h,delegateEvents as ne,ssrHydrationKey as S,useAssets as oe,NoHydration as z,Hydration as ae,ssrAttribute as T,HydrationScript as se}from"solid-js/web";import{lazy as ie,createComponent as le,sharedConfig as R,children as ce,createMemo as O,getOwner as ue,untrack as de,Show as K,on as he,createRoot as fe,createSignal as pe,onCleanup as G,Suspense as me,catchError as ge,ErrorBoundary as we}from"solid-js";import{provideRequestEvent as ve}from"solid-js/web/storage";import{g as ye,s as be,a as Ee,b as M,c as Se,d as Re,e as $e,f as Ae,R as Ce,h as Le,i as Te,j as H,k as Ne,l as F,m as ke,n as Pe,o as xe,p as Oe,q as De,r as Ie}from"./assets/action-BihcpICn.js";import{eventHandler as Me}from"h3";import{M as He,T as Fe}from"./assets/index-BdnVf8ln.js";import{H as J}from"./assets/HttpStatusCode-DH8IeaZe.js";import"node:async_hooks";const $={NORMAL:0,WILDCARD:1,PLACEHOLDER:2};function qe(e={}){const r={options:e,rootNode:V(),staticRoutesMap:{}},t=o=>e.strictTrailingSlash?o:o.replace(/\/$/,"")||"/";if(e.routes)for(const o in e.routes)q(r,t(o),e.routes[o]);return{ctx:r,lookup:o=>_e(r,t(o)),insert:(o,n)=>q(r,t(o),n),remove:o=>Ue(r,t(o))}}function _e(e,r){const t=e.staticRoutesMap[r];if(t)return t.data;const o=r.split("/"),n={};let a=!1,i=null,s=e.rootNode,c=null;for(let l=0;l<o.length;l++){const p=o[l];s.wildcardChildNode!==null&&(i=s.wildcardChildNode,c=o.slice(l).join("/"));const y=s.children.get(p);if(y===void 0){if(s&&s.placeholderChildren.length>1){const b=o.length-l;s=s.placeholderChildren.find(m=>m.maxDepth===b)||null}else s=s.placeholderChildren[0]||null;if(!s)break;s.paramName&&(n[s.paramName]=p),a=!0}else s=y}return(s===null||s.data===null)&&i!==null&&(s=i,n[s.paramName||"_"]=c,a=!0),s?a?{...s.data,params:a?n:void 0}:s.data:null}function q(e,r,t){let o=!0;const n=r.split("/");let a=e.rootNode,i=0;const s=[a];for(const c of n){let l;if(l=a.children.get(c))a=l;else{const p=je(c);l=V({type:p,parent:a}),a.children.set(c,l),p===$.PLACEHOLDER?(l.paramName=c==="*"?`_${i++}`:c.slice(1),a.placeholderChildren.push(l),o=!1):p===$.WILDCARD&&(a.wildcardChildNode=l,l.paramName=c.slice(3)||"_",o=!1),s.push(l),a=l}}for(const[c,l]of s.entries())l.maxDepth=Math.max(s.length-c,l.maxDepth||0);return a.data=t,o===!0&&(e.staticRoutesMap[r]=a),a}function Ue(e,r){let t=!1;const o=r.split("/");let n=e.rootNode;for(const a of o)if(n=n.children.get(a),!n)return t;if(n.data){const a=o.at(-1)||"";n.data=null,Object.keys(n.children).length===0&&n.parent&&(n.parent.children.delete(a),n.parent.wildcardChildNode=null,n.parent.placeholderChildren=[]),t=!0}return t}function V(e={}){return{type:e.type||$.NORMAL,maxDepth:0,parent:e.parent||null,children:new Map,data:e.data||null,paramName:e.paramName||null,wildcardChildNode:null,placeholderChildren:[]}}function je(e){return e.startsWith("**")?$.WILDCARD:e[0]===":"||e==="*"?$.PLACEHOLDER:$.NORMAL}const Y=[{page:!0,$component:{src:"src/routes/[...404].tsx?pick=default&pick=$css",build:()=>import("./_...404_.js"),import:()=>import("./_...404_.js")},path:"/*404",filePath:"/var/home/v/lab/solid/src/routes/[...404].tsx"},{page:!0,$component:{src:"src/routes/about.tsx?pick=default&pick=$css",build:()=>import("./about.js"),import:()=>import("./about.js")},path:"/about",filePath:"/var/home/v/lab/solid/src/routes/about.tsx"},{page:!0,$component:{src:"src/routes/index.tsx?pick=default&pick=$css",build:()=>import("./index.js"),import:()=>import("./index.js")},path:"/",filePath:"/var/home/v/lab/solid/src/routes/index.tsx"}],Be=We(Y.filter(e=>e.page));function We(e){function r(t,o,n,a){const i=Object.values(t).find(s=>n.startsWith(s.id+"/"));return i?(r(i.children||(i.children=[]),o,n.slice(i.id.length)),t):(t.push({...o,id:n,path:n.replace(/\([^)/]+\)/g,"").replace(/\/+/g,"/")}),t)}return e.sort((t,o)=>t.path.length-o.path.length).reduce((t,o)=>r(t,o,o.path,o.path),[])}function ze(e,r){const t=Ge.lookup(e);if(t&&t.route){const o=r==="HEAD"?t.route.$HEAD||t.route.$GET:t.route[`$${r}`];return o===void 0?void 0:{handler:o,params:t.params}}}function Ke(e){return e.$HEAD||e.$GET||e.$POST||e.$PUT||e.$PATCH||e.$DELETE}const Ge=qe({routes:Y.reduce((e,r)=>{if(!Ke(r))return e;let t=r.path.replace(/\([^)/]+\)/g,"").replace(/\/+/g,"/").replace(/\*([^/]*)/g,(o,n)=>`**:${n}`).split("/").map(o=>o.startsWith(":")||o.startsWith("*")?o:encodeURIComponent(o)).join("/");if(/:[^/]*\?/g.test(t))throw new Error(`Optional parameters are not supported in API routes: ${t}`);if(e[t])throw new Error(`Duplicate API routes for "${t}" found at "${e[t].route.path}" and "${r.path}"`);return e[t]={route:r},e},{})});function Je(e){e.forEach(r=>{if(!r.attrs.href)return;let t=document.head.querySelector(`link[href="${r.attrs.href}"]`);t||(t=document.createElement("link"),t.setAttribute("rel","preload"),t.setAttribute("as","style"),t.setAttribute("href",r.attrs.href),document.head.appendChild(t))})}var Ve=" ";const Ye={style:e=>L("style",e.attrs,()=>e.children,!0),link:e=>L("link",e.attrs,void 0,!0),script:e=>e.attrs.src?L("script",ee(()=>e.attrs,{get id(){return e.key}}),()=>w(Ve),!0):null,noscript:e=>L("noscript",e.attrs,()=>E(e.children),!0)};function P(e,r){let{tag:t,attrs:{key:o,...n}={key:void 0},children:a}=e;return Ye[t]({attrs:{...n,nonce:r},key:o,children:a})}function Qe(e,r,t,o="default"){return ie(async()=>{{const a=(await e.import())[o],s=(await r.inputs?.[e.src].assets()).filter(l=>l.tag==="style"||l.attrs.rel==="stylesheet");return typeof window<"u"&&Je(s),{default:l=>[...s.map(p=>P(p)),le(a,l)]}}})}function Q(){function e(t){return{...t,...t.$$route?t.$$route.require().route:void 0,info:{...t.$$route?t.$$route.require().route.info:{},filesystem:!0},component:t.$component&&Qe(t.$component,globalThis.MANIFEST.client,globalThis.MANIFEST.ssr),children:t.children?t.children.map(e):void 0}}return Be.map(e)}let _;const Xe=k?()=>N().routes:()=>_||(_=Q());function Ze(e){const r=ye(e.nativeEvent,"flash");if(r)try{let t=JSON.parse(r);if(!t||!t.result)return;const o=[...t.input.slice(0,-1),new Map(t.input[t.input.length-1])],n=t.error?new Error(t.result):t.result;return{input:o,url:t.url,pending:!1,result:t.thrown?void 0:n,error:t.thrown?n:void 0}}catch(t){console.error(t)}finally{be(e.nativeEvent,"flash","",{maxAge:0})}}async function et(e){const r=globalThis.MANIFEST.client;return globalThis.MANIFEST.ssr,e.response.headers.set("Content-Type","text/html"),Object.assign(e,{manifest:await r.json(),assets:[...await r.inputs[r.handler].assets()],router:{submission:Ze(e)},routes:Q(),complete:!1,$islands:new Set})}const tt=new Set([301,302,303,307,308]);function x(e){return e.status&&tt.has(e.status)?e.status:302}function rt(e,r,t={},o){return Me({handler:n=>{const a=Ee(n);return ve(a,async()=>{const i=ze(new URL(a.request.url).pathname,a.request.method);if(i){const m=await i.handler.import(),v=a.request.method==="HEAD"?m.HEAD||m.GET:m[a.request.method];a.params=i.params||{},R.context={event:a};const u=await v(a);if(u!==void 0)return u;if(a.request.method!=="GET")throw new Error(`API handler for ${a.request.method} "${a.request.url}" did not return a response.`)}const s=await r(a),c=typeof t=="function"?await t(s):{...t},l=c.mode||"stream";if(c.nonce&&(s.nonce=c.nonce),l==="sync"){const m=te(()=>(R.context.event=s,e(s)),c);if(s.complete=!0,s.response&&s.response.headers.get("Location")){const v=x(s.response);return M(n,s.response.headers.get("Location"),v)}return m}if(c.onCompleteAll){const m=c.onCompleteAll;c.onCompleteAll=v=>{j(s)(v),m(v)}}else c.onCompleteAll=j(s);if(c.onCompleteShell){const m=c.onCompleteShell;c.onCompleteShell=v=>{U(s,n)(),m(v)}}else c.onCompleteShell=U(s,n);const p=re(()=>(R.context.event=s,e(s)),c);if(s.response&&s.response.headers.get("Location")){const m=x(s.response);return M(n,s.response.headers.get("Location"),m)}if(l==="async")return p;const{writable:y,readable:b}=new TransformStream;return p.pipeTo(y),b})}})}function U(e,r){return()=>{if(e.response&&e.response.headers.get("Location")){const t=x(e.response);Se(r,t),Re(r,"Location",e.response.headers.get("Location"))}}}function j(e){return({write:r})=>{e.complete=!0;const t=e.response&&e.response.headers.get("Location");t&&r(`<script>window.location="${t}"<\/script>`)}}function nt(e,r,t){return rt(e,et,r)}const X=e=>r=>{const{base:t}=r,o=ce(()=>r.children),n=O(()=>$e(o(),r.base||""));let a;const i=Ae(e,n,()=>a,{base:t,singleFlight:r.singleFlight,transformUrl:r.transformUrl});return e.create&&e.create(i),h(Ce.Provider,{value:i,get children(){return h(ot,{routerState:i,get root(){return r.root},get preload(){return r.rootPreload||r.rootLoad},get children(){return[(a=ue())&&null,h(at,{routerState:i,get branches(){return n()}})]}})}})};function ot(e){const r=e.routerState.location,t=e.routerState.params,o=O(()=>e.preload&&de(()=>{F(!0),e.preload({params:t,location:r,intent:Le()||"initial"}),F(!1)}));return h(K,{get when(){return e.root},keyed:!0,get fallback(){return e.children},children:n=>h(n,{params:t,location:r,get data(){return o()},get children(){return e.children}})})}function at(e){if(k){const n=N();if(n&&n.router&&n.router.dataOnly){st(n,e.routerState,e.branches);return}n&&((n.router||(n.router={})).matches||(n.router.matches=e.routerState.matches().map(({route:a,path:i,params:s})=>({path:a.originalPath,pattern:a.pattern,match:i,params:s,info:a.info}))))}const r=[];let t;const o=O(he(e.routerState.matches,(n,a,i)=>{let s=a&&n.length===a.length;const c=[];for(let l=0,p=n.length;l<p;l++){const y=a&&a[l],b=n[l];i&&y&&b.route.key===y.route.key?c[l]=i[l]:(s=!1,r[l]&&r[l](),fe(m=>{r[l]=m,c[l]=Te(e.routerState,c[l-1]||e.routerState.base,B(()=>o()[l+1]),()=>e.routerState.matches()[l])}))}return r.splice(n.length).forEach(l=>l()),i&&s?i:(t=c[0],c)}));return B(()=>o()&&t)()}const B=e=>()=>h(K,{get when(){return e()},keyed:!0,children:r=>h(Ne.Provider,{value:r,get children(){return r.outlet()}})});function st(e,r,t){const o=new URL(e.request.url),n=H(t,new URL(e.router.previousUrl||e.request.url).pathname),a=H(t,o.pathname);for(let i=0;i<a.length;i++){(!n[i]||a[i].route!==n[i].route)&&(e.router.dataOnly=!0);const{route:s,params:c}=a[i];s.preload&&s.preload({params:c,location:r.location,intent:"preload"})}}function it([e,r],t,o){return[e,o?n=>r(o(n)):r]}function lt(e){let r=!1;const t=n=>typeof n=="string"?{value:n}:n,o=it(pe(t(e.get()),{equals:(n,a)=>n.value===a.value&&n.state===a.state}),void 0,n=>(!r&&e.set(n),R.registry&&!R.done&&(R.done=!0),n));return e.init&&G(e.init((n=e.get())=>{r=!0,o[1](t(n)),r=!1})),X({signal:o,create:e.create,utils:e.utils})}function ct(e,r,t){return e.addEventListener(r,t),()=>e.removeEventListener(r,t)}function ut(e,r){const t=e&&document.getElementById(e);t?t.scrollIntoView():r&&window.scrollTo(0,0)}function dt(e){const r=new URL(e);return r.pathname+r.search}function ht(e){let r;const t={value:e.url||(r=N())&&dt(r.request.url)||""};return X({signal:[()=>t,o=>Object.assign(t,o)]})(e)}function ft(e=!0,r=!1,t="/_server",o){return n=>{const a=n.base.path(),i=n.navigatorFactory(n.base);let s,c;function l(u){return u.namespaceURI==="http://www.w3.org/2000/svg"}function p(u){if(u.defaultPrevented||u.button!==0||u.metaKey||u.altKey||u.ctrlKey||u.shiftKey)return;const d=u.composedPath().find(I=>I instanceof Node&&I.nodeName.toUpperCase()==="A");if(!d||r&&!d.hasAttribute("link"))return;const g=l(d),f=g?d.href.baseVal:d.href;if((g?d.target.baseVal:d.target)||!f&&!d.hasAttribute("state"))return;const A=(d.getAttribute("rel")||"").split(/\s+/);if(d.hasAttribute("download")||A&&A.includes("external"))return;const C=g?new URL(f,document.baseURI):new URL(f);if(!(C.origin!==window.location.origin||a&&C.pathname&&!C.pathname.toLowerCase().startsWith(a.toLowerCase())))return[d,C]}function y(u){const d=p(u);if(!d)return;const[g,f]=d,D=n.parsePath(f.pathname+f.search+f.hash),A=g.getAttribute("state");u.preventDefault(),i(D,{resolve:!1,replace:g.hasAttribute("replace"),scroll:!g.hasAttribute("noscroll"),state:A?JSON.parse(A):void 0})}function b(u){const d=p(u);if(!d)return;const[g,f]=d;o&&(f.pathname=o(f.pathname)),n.preloadRoute(f,g.getAttribute("preload")!=="false")}function m(u){clearTimeout(s);const d=p(u);if(!d)return c=null;const[g,f]=d;c!==g&&(o&&(f.pathname=o(f.pathname)),s=setTimeout(()=>{n.preloadRoute(f,g.getAttribute("preload")!=="false"),c=g},20))}function v(u){if(u.defaultPrevented)return;let d=u.submitter&&u.submitter.hasAttribute("formaction")?u.submitter.getAttribute("formaction"):u.target.getAttribute("action");if(!d)return;if(!d.startsWith("https://action/")){const f=new URL(d,ke);if(d=n.parsePath(f.pathname+f.search),!d.startsWith(t))return}if(u.target.method.toUpperCase()!=="POST")throw new Error("Only POST forms are supported for Actions");const g=Pe.get(d);if(g){u.preventDefault();const f=new FormData(u.target,u.submitter);g.call({r:n,f:u.target},u.target.enctype==="multipart/form-data"?f:new URLSearchParams(f))}}ne(["click","submit"]),document.addEventListener("click",y),e&&(document.addEventListener("mousemove",m,{passive:!0}),document.addEventListener("focusin",b,{passive:!0}),document.addEventListener("touchstart",b,{passive:!0})),document.addEventListener("submit",v),G(()=>{document.removeEventListener("click",y),e&&(document.removeEventListener("mousemove",m),document.removeEventListener("focusin",b),document.removeEventListener("touchstart",b)),document.removeEventListener("submit",v)})}}function pt(e){if(k)return ht(e);const r=()=>{const o=window.location.pathname.replace(/^\/+/,"/")+window.location.search,n=window.history.state&&window.history.state._depth&&Object.keys(window.history.state).length===1?void 0:window.history.state;return{value:o+window.location.hash,state:n}},t=xe();return lt({get:r,set({value:o,replace:n,scroll:a,state:i}){n?window.history.replaceState(Oe(i),"",o):window.history.pushState(i,"",o),ut(decodeURIComponent(window.location.hash.slice(1)),a),De()},init:o=>ct(window,"popstate",Ie(o,n=>{if(n&&n<0)return!t.confirm(n);{const a=r();return!t.confirm(a.value,{state:a.state})}})),create:ft(e.preload,e.explicitLinks,e.actionBase,e.transformUrl),utils:{go:o=>window.history.go(o),beforeLeave:t}})(e)}var mt=["<nav",' class="flex items-center justify-between flex-wrap bg-gray-800 p-4 shadow-md"><div class="text-white font-bold text-xl">MyApp</div><div class="space-x-4"><a href="/" class="text-gray-300 hover:text-white transition-colors">Home</a><a href="/about" class="text-gray-300 hover:text-white transition-colors">About</a></div></nav>'],gt=["<div",">","</div>"];function wt(e){return[w(mt,S()),w(gt,S(),E(e.children))]}function vt(){return h(pt,{root:e=>h(He,{get children(){return[h(Fe,{children:"SolidStart - Basic"}),h(wt,{get children(){return h(me,{get children(){return e.children}})}})]}}),get children(){return h(Xe,{})}})}var yt=["<span",' style="font-size:1.5em;text-align:center;position:fixed;left:0px;bottom:55%;width:100%;">',"</span>"],bt=["<span",' style="font-size:1.5em;text-align:center;position:fixed;left:0px;bottom:55%;width:100%;">500 | Internal Server Error</span>'];const Et=e=>{const r=k?"500 | Internal Server Error":"Error | Uncaught Client Exception";return h(we,{fallback:t=>(console.error(t),[w(yt,S(),E(r)),h(J,{code:500})]),get children(){return e.children}})},St=e=>{let r=!1;const t=ge(()=>e.children,o=>{console.error(o),r=!!o});return r?[w(bt,S()),h(J,{code:500})]:t};var W=["<script",">","<\/script>"],Rt=["<script",' type="module"'," async","><\/script>"],$t=["<script",' type="module" async',"><\/script>"];const At=w("<!DOCTYPE html>");function Z(e,r,t=[]){for(let o=0;o<r.length;o++){const n=r[o];if(n.path!==e[0].path)continue;let a=[...t,n];if(n.children){const i=e.slice(1);if(i.length===0||(a=Z(i,n.children,a),!a))continue}return a}}function Ct(e){const r=N(),t=r.nonce;let o=[];return Promise.resolve().then(async()=>{let n=[];if(r.router&&r.router.matches){const a=[...r.router.matches];for(;a.length&&(!a[0].info||!a[0].info.filesystem);)a.shift();const i=a.length&&Z(a,r.routes);if(i){const s=globalThis.MANIFEST.client.inputs;for(let c=0;c<i.length;c++){const l=i[c],p=s[l.$component.src];n.push(p.assets())}}}o=await Promise.all(n).then(a=>[...new Map(a.flat().map(i=>[i.attrs.key,i])).values()].filter(i=>i.attrs.rel==="modulepreload"&&!r.assets.find(s=>s.attrs.key===i.attrs.key)))}),oe(()=>o.length?o.map(n=>P(n)):void 0),h(z,{get children(){return[At,h(St,{get children(){return h(e.document,{get assets(){return[h(se,{}),r.assets.map(n=>P(n,t))]},get scripts(){return t?[w(W,S()+T("nonce",E(t,!0),!1),`window.manifest = ${JSON.stringify(r.manifest)}`),w(Rt,S(),T("nonce",E(t,!0),!1),T("src",E(globalThis.MANIFEST.client.inputs[globalThis.MANIFEST.client.handler].output.path,!0),!1))]:[w(W,S(),`window.manifest = ${JSON.stringify(r.manifest)}`),w($t,S(),T("src",E(globalThis.MANIFEST.client.inputs[globalThis.MANIFEST.client.handler].output.path,!0),!1))]},get children(){return h(ae,{get children(){return h(Et,{get children(){return h(vt,{})}})}})}})}})]}})}var Lt=['<head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/favicon.ico">',"</head>"],Tt=["<html",' lang="en">','<body><div id="app">',"</div><!--$-->","<!--/--></body></html>"];const Ht=nt(()=>h(Ct,{document:({assets:e,children:r,scripts:t})=>w(Tt,S(),h(z,{get children(){return w(Lt,E(e))}}),E(r),E(t))}));export{Ht as default};
